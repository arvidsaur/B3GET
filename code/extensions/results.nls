;----------------------------------------------------------------------------------------------     
;
;                                      dP   dP            
;                                      88   88            
;  88d888b. .d8888b. .d8888b. dP    dP 88 d8888P .d8888b. 
;  88'  `88 88ooood8 Y8ooooo. 88    88 88   88   Y8ooooo. 
;  88       88.  ...       88 88.  .88 88   88         88 
;  dP       `88888P' `88888P' `88888P' dP   dP   `88888P' 
; 
; Â© 2021 K N Crouse  
;----------------------------------------------------------------------------------------------                                                      
; 
; This B3GET extension contains all functions related to output results. Data collection 
; can be turned ON or OFF with the OUTPUT-RESULTS? switch on the user interface. When ON is selected, 
; the OUTPUT-RESULTS function is applied once every timestep. Agent state variables are accessible 
; during data collection to record complete agent histories. This extension uses the IMPORT-EXPORT
; extension to record data at the simulation, group, or individual level and the VERIFICATION
; extension to run code verification checks. Modify the USER SETTINGS below for specific data
; collection preferences.
;  
;----------------------------------------------------------------------------------------------

to output-results
  
  carefully [
    
    ;----------------------------------------------------------------------------------------------     
    ; VERIFICATION : collect data on outcomes of periodic code verification checks
    ;----------------------------------------------------------------------------------------------
    
    if ( verification-rate > 0 and ( random-float 1.0 < verification-rate ) ) [   ; If user wants to collect verification data and dice-roll wins
      profiler:start ]           ; and start a new profiler recording
    
    if ( profiler:calls "go" >= 1 ) [  ; If profiler is running
      record-verification              ; Record dynamic verification data
      profiler:stop                    ; and stop the profiler
      profiler:reset             ; reset the profiler data
    ]                  
    
    ;----------------------------------------------------------------------------------------------     
    ; SUMMARY : collect summary data of simulations or individuals
    ;----------------------------------------------------------------------------------------------
    
    if ( simulation-summary-ticks > 0 and ticks = simulation-summary-ticks ) [ simulation-summary ]
    if ( record-individuals-on ) [ ask anima1s with [ ticks.at.death > 0 and ticks = ( ticks.at.death + 1 ) ] [ individual-summary ] ]
    
    ;----------------------------------------------------------------------------------------------     
    ; SCAN : collect data on the current state of simulations, groups, or individuals
    ;----------------------------------------------------------------------------------------------
    
    if ( simulation-scan-ticks > 0 and ticks > 0 and ceiling ( ticks / simulation-scan-ticks ) = (ticks / simulation-scan-ticks ) ) [ 
      scan-simulation
    ]
    
    if ( group-scan-ticks > 0 and ticks > 0 and ceiling ( ticks / group-scan-ticks ) = ( ticks / group-scan-ticks ) ) [ 
      if ( any? anima1s with [ is.alive ] ) [ foreach remove-duplicates [ group.identity ] of anima1s with [ is.alive ] [ g -> scan-group g ]]
    ]
    
    if ( individual-scan-ticks > 0 and ticks > 0 and ceiling (ticks / individual-scan-ticks ) = (ticks / individual-scan-ticks ) ) [ 
      if ( any? anima1s with [ is.alive ] ) [ ask anima1s with [ is.alive ] [ scan-agent ]]
    ]
    
    if ( view-scan-ticks > 0 and ceiling ( ticks / view-scan-ticks ) = ( ticks / view-scan-ticks ) ) [
      let saved-subject subject
      reset-perspective
      export-view ( word path-to-experiment "view-" simulation-id "-" ticks ".png")
      output-territories
      export-view ( word path-to-experiment "territories-" simulation-id "-" ticks ".png")
      if ( saved-subject != nobody ) [ watch saved-subject ]
    ]
    
    if ( genotype-scan-ticks > 0 and ceiling ( ticks / genotype-scan-ticks ) = ( ticks / genotype-scan-ticks ) and any? anima1s with [ is.alive ] ) [
      scan-genotype
    ]
    
    ;----------------------------------------------------------------------------------------------     
    ; FOCAL FOLLOW
    ;----------------------------------------------------------------------------------------------
    
    ; There is a small chance to starting "following" an agent if they were born this timestep 
    if ( focal-follow-rate > 0 and subject = nobody ) [ if ( random-float 1.0 < focal-follow-rate and any? anima1s with [ age.in.ticks = 0 ] ) [ watch one-of anima1s with [ age.in.ticks = 0 ] ]]
    
    if ( focal-follow-rate > 0 and subject != nobody and [fully.decayed] of subject = true ) [ reset-perspective ] ; when focal subject dies and fully decays, stop following them
    
    ; If currently "following" an agent, take records of this subject
    if ( focal-follow-rate > 0 and subject != nobody ) [ 
      ask subject [ record-actions ]
    ]
    
  ] [ print ( word "OUTPUT RESULTS ERROR: " error-message ) ]
  
end


; --------------------------------------------------------------------------------------------------------- ;
;                            _       _ 
; __      __   ___    _ __  | |   __| |
; \ \ /\ / /  / _ \  | '__| | |  / _` |
;  \ V  V /  | (_) | | |    | | | (_| |
;   \_/\_/    \___/  |_|    |_|  \__,_|
;                                                                                                   
; --------------------------------------------------------------------------------------------------------- ;

to record-world
  let file-path ( word path-to-experiment "w" but-first simulation-id "-" ticks ".csv" )
  export-world file-path
  update-metafile "world" ( word "w" but-first simulation-id "-" ticks ) ( word "WORLD SAVED" )
end
  
; --------------------------------------------------------------------------------------------------------- ; 
;                        _    __   _                  _     _                 
; __   __   ___   _ __  (_)  / _| (_)   ___    __ _  | |_  (_)   ___    _ __  
; \ \ / /  / _ \ | '__| | | | |_  | |  / __|  / _` | | __| | |  / _ \  | '_ \ 
;  \ V /  |  __/ | |    | | |  _| | | | (__  | (_| | | |_  | | | (_) | | | | |
;   \_/    \___| |_|    |_| |_|   |_|  \___|  \__,_|  \__| |_|  \___/  |_| |_|
;                                                                             
; --------------------------------------------------------------------------------------------------------- ;

to record-verification

  let file-path ( word path-to-experiment "dynamic-verification.csv" ) ; Set the file path for the verification file
  let new-tape generate-verification-tape                              ; Run the verification subroutine and record data
  
  ifelse ( not file-exists? file-path and simulation-id != 0 )         ; If the file does not already exist
  
  [ file-open file-path                                                ; Open verification file
    foreach new-tape [ l -> file-print csv:to-string (list l ) ] ]     ; Record the headers and data to verification file
  
  [ file-open file-path                                                ; Open verification file
    file-print csv:to-string (list last new-tape ) ]                   ; Record data only to verification file
  
  file-close                                                           ; Close verification file
  
end


; --------------------------------------------------------------------------------------------------------- ;                                                                 
;                                 _                                                         
;   __ _    ___   _ __     ___   | |_   _   _   _ __     ___     ___    ___    __ _   _ __  
;  / _` |  / _ \ | '_ \   / _ \  | __| | | | | | '_ \   / _ \   / __|  / __|  / _` | | '_ \ 
; | (_| | |  __/ | | | | | (_) | | |_  | |_| | | |_) | |  __/   \__ \ | (__  | (_| | | | | |
;  \__, |  \___| |_| |_|  \___/   \__|  \__, | | .__/   \___|   |___/  \___|  \__,_| |_| |_|
;  |___/                                |___/  |_|                                                       
; --------------------------------------------------------------------------------------------------------- ; 

to scan-genotype ; agent subroutine, sta2us only
  
  if ( any? anima1s ) [
    
    let file-path ( word path-to-experiment "genotypes-" genotype ".csv" )
    
    if ( not file-exists? file-path and simulation-id != 0 )
    
    [ file-open file-path
      file-print csv:to-string (list 
        
        (sentence
          "date-and-time"
          "path-to-experiment"
          "model-version"
          "model-structure"
          "genotype-reader"
          "simulation-id"
          "behaviorspace-experiment-name"
          "population" 
          "genotype"
          "plant-annual-cycle" 
          "plant-daily-cycle" 
          "plant-seasonality" 
          "plant-quality"
          "plant-minimum-neighbors" 
          "plant-maximum-neighbors" 
          "world-width" 
          "world-height"
          "output-results?" 
          "selection-on?"
          "deterioration-rate"
          "maximum-visual-range"
          "base-litter-size"
          "timesteps"
          map but-last [chromosome.I] of min-one-of anima1s [ generation.number ] ))]
    
    file-open file-path

    let combined-list []
    
    let i 0
    let chrome-length max [ length chromosome.I ] of anima1s
    while [ i < chrome-length ] [
      let list-i [ last item i chromosome.I ] of anima1s with [ is.alive and length chromosome.I > i and is-number? last item i chromosome.I ]
      let list-ii [ last item i chromosome.II ] of anima1s with [ is.alive and length chromosome.II > i and is-number? last item i chromosome.II ]
      let item-I ifelse-value ( length list-i < 1 ) [ 0 ] [ mean list-i ]
      let item-II ifelse-value ( length list-ii < 1 ) [ 0 ] [ mean list-ii ]
      set combined-list lput ( item-I + item-II ) combined-list
      set i i + 1 ]
    
    file-print csv:to-string ( list 
      
      (sentence
        date-and-time
        path-to-experiment
        model-version
        model-structure
        genotype-reader
        simulation-id
        behaviorspace-experiment-name
        population
        genotype
        plant-annual-cycle
        plant-daily-cycle
        plant-seasonality
        plant-quality
        plant-minimum-neighbors
        plant-maximum-neighbors
        world-width
        world-height
        output-results?
        selection-on?
        deterioration-rate
        maximum-visual-range
        base-litter-size
        ticks
        combined-list ))
    
    file-close 
    
  ] 
  
end

; --------------------------------------------------------------------------------------------------------- ; 
;                 _     _                       
;   __ _    ___  | |_  (_)   ___    _ __    ___ 
;  / _` |  / __| | __| | |  / _ \  | '_ \  / __|
; | (_| | | (__  | |_  | | | (_) | | | | | \__ \
;  \__,_|  \___|  \__| |_|  \___/  |_| |_| |___/
;                                               
; --------------------------------------------------------------------------------------------------------- ;

to record-actions ; agent subroutine
  
  let file-path ( word path-to-experiment "actions-" simulation-id "-" my.identity ".csv" )
  
  if ( not file-exists? file-path and simulation-id != 0 )
  
  [ file-open file-path
    file-print csv:to-string (list (list 
      
      "date-and-time"
      "path-to-experiment"
      "model-version"
      "model-structure"
      "genotype-reader"
      "simulation-id"
      "behaviorspace-experiment-name"
      "population" 
      "genotype"
      "plant-annual-cycle" 
      "plant-daily-cycle" 
      "plant-seasonality" 
      "plant-quality"
      "plant-minimum-neighbors" 
      "plant-maximum-neighbors" 
      "world-width" 
      "world-height"
      "output-results?" 
      "selection-on?"
      "deterioration-rate"
      "maximum-visual-range"
      "base-litter-size"
      
      "timesteps"
      "solar-status"
      "current-season"
      "plant-patchiness"
      "population-density"
      "current-plant-abundance"
      
      ; subject
      "color" 
      "heading" 
      "xcor" 
      "ycor" 
      "my.identity" 
      "age.in.ticks" 
      "generation.number"
      "biological.sex" 
      "life.history" 
      "fertility.status" 
      "group.identity" 
      "is.alive" 
      "carried.items"
      "yellow.signal" 
      "red.signal" 
      "blue.signal"
      "body.size" 
      "body.shade" 
      "is.resting"
      "hidden.chance"
      "fully.decayed"
      "survival.chance" 
      "energy.supply"
      "bite.capacity" 
      "mutation.chance"
      "sex.ratio" 
      "litter.size" 
      "conception.chance"
      "visual.angle" 
      "visual.range" 
      "day.perception"
      "night.perception" 
      "yellow.chance" 
      "red.chance" 
      "blue.chance"
      "birthing.chance" 
      "weaning.chance" 
      "infancy.chance"
      "juvenility.chance" 
      "adulthood.chance" 
      "x.magnitude" 
      "y.magnitude"
      "distance.traveled"  
      "foraging.gains"  
      "total.energy.gains"
      "total.energy.cost"
      "help-from-count"
      "attack-from-count"
      "copulations-count"
      "unique-mates-count"
      "conceptions-count"
      "group-transfers-count"
      "infanticide-count"
      "whole.related.help.cost"
      "half.related.help.cost"
      "fourth.related.help.cost"
      "eighth.related.help.cost"
      "not.related.help.cost"
      "whole.related.attack.cost"
      "half.related.attack.cost"
      "fourth.related.attack.cost"
      "eighth.related.attack.cost"
      "not.related.attack.cost"
      
      "action-ego"
      "action-target"
      "action-name"
      "action-cost"
      
    )) ]
  
  file-open file-path
  
  let action-list filter [ a -> item 0 a = ticks and ( item 1 a = self or item 2 a = self ) ] [] ; FIX recent-actions-completed
  
  foreach action-list [ action ->
    
    if ( is-anima1? item 1 action ) [
      
      ask ( item 1 action ) [
        
        file-print csv:to-string ( list ( list
          
          date-and-time
          path-to-experiment
          model-version
          model-structure
          genotype-reader
          simulation-id
          behaviorspace-experiment-name
          population
          genotype
          plant-annual-cycle
          plant-daily-cycle
          plant-seasonality
          plant-quality
          plant-minimum-neighbors
          plant-maximum-neighbors
          world-width
          world-height
          output-results?
          selection-on?
          deterioration-rate
          maximum-visual-range
          base-litter-size
          
          ticks
          solar-status
          current-season
          plant-patchiness
          population-density
          current-plant-abundance
          
          ; subject
          color
          heading 
          xcor
          ycor
          my.identity
          age.in.ticks 
          generation.number
          biological.sex
          life.history
          fertility.status 
          group.identity
          is.alive
          carried.items
          yellow.signal
          red.signal
          blue.signal
          body.size
          body.shade
          is.resting
          hidden.chance
          fully.decayed
          survival.chance 
          energy.supply
          bite.capacity
          mutation.chance
          sex.ratio
          litter.size
          conception.chance
          visual.angle
          visual.range
          day.perception
          night.perception
          yellow.chance
          red.chance
          blue.chance
          birthing.chance
          weaning.chance 
          infancy.chance
          juvenility.chance
          adulthood.chance
          x.magnitude
          y.magnitude
          distance.traveled
          foraging.gains
          total.energy.gains
          total.energy.cost
          help-from-count
          attack-from-count
          copulations-count
          unique-mates-count
          conceptions-count
          group-transfers-count
          infanticide-count
          whole.related.help.cost
          half.related.help.cost
          fourth.related.help.cost
          eighth.related.help.cost
          not.related.help.cost
          whole.related.attack.cost
          half.related.attack.cost
          fourth.related.attack.cost
          eighth.related.attack.cost
          not.related.attack.cost
          
          ifelse-value ( is-anima1? item 1 action ) [ [my.identity] of item 1 action ] [ item 1 action ]
          ifelse-value ( is-anima1? item 2 action ) [ [my.identity] of item 2 action ] [ item 2 action ]
          item 3 action
          item 4 action
          
  ))]]]
  
  file-close 
  
end

; --------------------------------------------------------------------------------------------------------- ;
;  _               _   _           _       _                   _                                
; (_)  _ __     __| | (_) __   __ (_)   __| |  _   _    __ _  | |    ___    ___    __ _   _ __  
; | | | '_ \   / _` | | | \ \ / / | |  / _` | | | | |  / _` | | |   / __|  / __|  / _` | | '_ \ 
; | | | | | | | (_| | | |  \ V /  | | | (_| | | |_| | | (_| | | |   \__ \ | (__  | (_| | | | | |
; |_| |_| |_|  \__,_| |_|   \_/   |_|  \__,_|  \__,_|  \__,_| |_|   |___/  \___|  \__,_| |_| |_|
;                                                                                                                                        
; --------------------------------------------------------------------------------------------------------- ;

to scan-agent
  
  let file-path ( word path-to-experiment "individual-scans.csv" )
  
  if ( not file-exists? file-path and simulation-id != 0 )
  
  [ file-open file-path
    file-print csv:to-string (list (list 
      
      "date-and-time"
      "path-to-experiment"
      "model-version"
      "model-structure"
      "genotype-reader"
      "simulation-id"
      "behaviorspace-experiment-name"
      "population" 
      "genotype"
      "plant-annual-cycle" 
      "plant-daily-cycle" 
      "plant-seasonality" 
      "plant-quality"
      "plant-minimum-neighbors" 
      "plant-maximum-neighbors" 
      "world-width" 
      "world-height"
      "output-results?" 
      "selection-on?" 
      "deterioration-rate"
      "maximum-visual-range"
      "base-litter-size"
      
      "current-timesteps"
      "current-solar-status"
      "current-season"
      "current-plant-patchiness"
      "current-plant-abundance"
      "current-population-density"
      
      "focal-subject"
      "color" 
      "heading" 
      "xcor" 
      "ycor" 
      "my.identity" 
      "age.in.ticks" 
      "generation.number"
      "biological.sex" 
      "life.history" 
      "fertility.status" 
      "group.identity" 
      "is.alive" 
      "carried.items"
      "yellow.signal" 
      "red.signal" 
      "blue.signal"
      "body.size" 
      "body.shade" 
      "is.resting"
      "hidden.chance"
      "fully.decayed"
      "survival.chance" 
      "energy.supply"
      "bite.capacity" 
      "mutation.chance"
      "sex.ratio" 
      "litter.size" 
      "conception.chance"
      "visual.angle" 
      "visual.range" 
      "day.perception"
      "night.perception" 
      "yellow.chance" 
      "red.chance" 
      "blue.chance"
      "birthing.chance" 
      "weaning.chance" 
      "infancy.chance"
      "juvenility.chance" 
      "adulthood.chance" 
      "x.magnitude" 
      "y.magnitude"
      "distance.traveled" 
      "foraging.gains"  
      "total.energy.gains"
      "total.energy.cost"
      "help-from-count"
      "attack-from-count"
      "copulations-count"
      "unique-mates-count"
      "conceptions-count"
      "group-transfers-count"
      "infanticide-count"
      "whole.related.help.cost"
      "half.related.help.cost"
      "fourth.related.help.cost"
      "eighth.related.help.cost"
      "not.related.help.cost"
      "whole.related.attack.cost"
      "half.related.attack.cost"
      "fourth.related.attack.cost"
      "eighth.related.attack.cost"
      "not.related.attack.cost"
      
  )) ]
  
  file-open file-path
  
  file-print csv:to-string ( list ( list
    
    date-and-time
    path-to-experiment
    model-version
    model-structure
    genotype-reader
    simulation-id
    behaviorspace-experiment-name
    population
    genotype
    plant-annual-cycle
    plant-daily-cycle
    plant-seasonality
    plant-quality
    plant-minimum-neighbors
    plant-maximum-neighbors
    world-width
    world-height
    output-results?
    selection-on?
    deterioration-rate
    maximum-visual-range
    base-litter-size

    ticks
    solar-status
    current-season
    plant-patchiness
    current-plant-abundance
    population-density
   
    focal-subject
    color
    heading 
    xcor
    ycor
    my.identity
    age.in.ticks 
    generation.number
    biological.sex
    life.history
    fertility.status 
    group.identity
    is.alive
    carried.items
    yellow.signal
    red.signal
    blue.signal
    body.size
    body.shade
    is.resting
    hidden.chance
    fully.decayed
    survival.chance 
    energy.supply
    bite.capacity
    mutation.chance
    sex.ratio
    litter.size
    conception.chance
    visual.angle
    visual.range
    day.perception
    night.perception
    yellow.chance
    red.chance
    blue.chance
    birthing.chance
    weaning.chance 
    infancy.chance
    juvenility.chance
    adulthood.chance
    x.magnitude
    y.magnitude
    distance.traveled 
    foraging.gains
    total.energy.gains
    total.energy.cost
    help-from-count
    attack-from-count
    copulations-count
    unique-mates-count
    conceptions-count
    group-transfers-count
    infanticide-count
    whole.related.help.cost
    half.related.help.cost
    fourth.related.help.cost
    eighth.related.help.cost
    not.related.help.cost
    whole.related.attack.cost
    half.related.attack.cost
    fourth.related.attack.cost
    eighth.related.attack.cost
    not.related.attack.cost
    
  ))
  
  file-close 
  
end

  
; ------------------------------------------------------------------------------------------------------------------------------ ;  
;  _               _   _           _       _                   _                                                                
; (_)  _ __     __| | (_) __   __ (_)   __| |  _   _    __ _  | |    ___   _   _   _ __ ___    _ __ ___     __ _   _ __   _   _ 
; | | | '_ \   / _` | | | \ \ / / | |  / _` | | | | |  / _` | | |   / __| | | | | | '_ ` _ \  | '_ ` _ \   / _` | | '__| | | | |
; | | | | | | | (_| | | |  \ V /  | | | (_| | | |_| | | (_| | | |   \__ \ | |_| | | | | | | | | | | | | | | (_| | | |    | |_| |
; |_| |_| |_|  \__,_| |_|   \_/   |_|  \__,_|  \__,_|  \__,_| |_|   |___/  \__,_| |_| |_| |_| |_| |_| |_|  \__,_| |_|     \__, |
;                                                                                                                         |___/ 
;
; ------------------------------------------------------------------------------------------------------------------------------- ;
  
to individual-summary
  
  let file-path ( word path-to-experiment "individuals-" population ".csv" )
  
  if ( not file-exists? file-path and simulation-id != 0 )
  
  [ file-open file-path
    file-print csv:to-string (list (list 
      
      "date-and-time"
      "path-to-experiment"
      "model-version"
      "model-structure"
      "genotype-reader"
      "simulation-id"
      "behaviorspace-experiment-name"
      "population" 
      "genotype"
      "plant-annual-cycle" 
      "plant-daily-cycle" 
      "plant-seasonality" 
      "plant-quality"
      "plant-minimum-neighbors" 
      "plant-maximum-neighbors" 
      "world-width" 
      "world-height"
      "output-results?" 
      "selection-on?" 
      "deterioration-rate"
      "maximum-visual-range"
      "base-litter-size"

      "focal-subject"
      "color" 
      "heading" 
      "xcor" 
      "ycor" 
      "my.identity" 
      "age.in.ticks" 
      "generation.number"
      "biological.sex" 
      "life.history" 
      "fertility.status" 
      "group.identity" 
      "is.alive" 
      "carried.items"
      "yellow.signal" 
      "red.signal" 
      "blue.signal"
      "body.size" 
      "body.shade" 
      "is.resting"
      "hidden.chance"
      "fully.decayed"
      "survival.chance" 
      "energy.supply"
      "bite.capacity" 
      "mutation.chance"
      "sex.ratio" 
      "litter.size" 
      "conception.chance"
      "visual.angle" 
      "visual.range" 
      "day.perception"
      "night.perception" 
      "yellow.chance" 
      "red.chance" 
      "blue.chance"
      "birthing.chance" 
      "weaning.chance" 
      "infancy.chance"
      "juvenility.chance" 
      "adulthood.chance" 
      "x.magnitude" 
      "y.magnitude"
      "distance.traveled" 
      "foraging.gains"  
      "total.energy.gains"
      "total.energy.cost"
      "help-from-count"
      "attack-from-count"
      "copulations-count"
      "unique-mates-count"
      "conceptions-count"
      "group-transfers-count"
      "infanticide-count"
      "whole.related.help.cost"
      "half.related.help.cost"
      "fourth.related.help.cost"
      "eighth.related.help.cost"
      "not.related.help.cost"
      "whole.related.attack.cost"
      "half.related.attack.cost"
      "fourth.related.attack.cost"
      "eighth.related.attack.cost"
      "not.related.attack.cost"
      
      "mother.identity"
      "father.identity"
      "natal.group.identity"
      "natal.group.size"
      "death.group.identity"
      "death.group.size"
      "identity.I"
      "identity.II"
      "chromosome.I"
      "chromosome.II"
      "ticks.at.conception"
      "ticks.at.birth"
      "ticks.at.weaning"
      "ticks.at.sexual.maturity"
      "ticks.at.death"
      "cause.of.death"
      "gestation-duration"
      "lactation-duration"
      "juvenile-duration"
      "lifespan"
      "adult.hidden.chance"
      "adult.survival.chance"
      "adult.body.size"
      "adult.body.shade"
      "adult.energy.supply"
      "adult.bite.capacity"
      "adult.mutation.chance"
      "adult.sex.ratio"
      "adult.litter.size"
      "adult.conception.chance"
      "adult.visual.angle"
      "adult.visual.range"
      "adult.day.perception"
      "adult.night.perception"
      "adult.yellow.chance"
      "adult.red.chance"
      "adult.blue.chance"
      "mother.initiated.birth"
      "mother.initiated.weaning"
      
      "lifetime-plant-abundance"
      "lifetime-plant-patchiness"
      "lifetime-population-size"

  )) ]
  
  file-open file-path
  
  file-print csv:to-string ( list ( list
    
    date-and-time
    path-to-experiment
    model-version
    model-structure
    genotype-reader
    simulation-id
    behaviorspace-experiment-name
    population
    genotype
    plant-annual-cycle
    plant-daily-cycle
    plant-seasonality
    plant-quality
    plant-minimum-neighbors
    plant-maximum-neighbors
    world-width
    world-height
    output-results?
    selection-on?
    deterioration-rate
    maximum-visual-range
    base-litter-size
    
    focal-subject
    color
    heading 
    xcor
    ycor
    my.identity
    age.in.ticks 
    generation.number
    biological.sex
    life.history
    fertility.status 
    group.identity
    is.alive
    carried.items
    yellow.signal
    red.signal
    blue.signal
    body.size
    body.shade
    is.resting
    hidden.chance
    fully.decayed
    survival.chance 
    energy.supply
    bite.capacity
    mutation.chance
    sex.ratio
    litter.size
    conception.chance
    visual.angle
    visual.range
    day.perception
    night.perception
    yellow.chance
    red.chance
    blue.chance
    birthing.chance
    weaning.chance 
    infancy.chance
    juvenility.chance
    adulthood.chance
    x.magnitude
    y.magnitude
    distance.traveled 
    foraging.gains
    total.energy.gains
    total.energy.cost
    help-from-count
    attack-from-count
    copulations-count
    unique-mates-count
    conceptions-count
    group-transfers-count
    infanticide-count
    whole.related.help.cost
    half.related.help.cost
    fourth.related.help.cost
    eighth.related.help.cost
    not.related.help.cost
    whole.related.attack.cost
    half.related.attack.cost
    fourth.related.attack.cost
    eighth.related.attack.cost
    not.related.attack.cost
    
    mother.identity
    father.identity
    natal.group.identity
    natal.group.size
    death.group.identity
    death.group.size
    identity.I
    identity.II
    chromosome.I
    chromosome.II
    ticks.at.conception
    ticks.at.birth
    ticks.at.weaning
    ticks.at.sexual.maturity
    ticks.at.death
    cause.of.death
    gestation-duration
    lactation-duration
    juvenile-duration
    lifespan
    adult.hidden.chance
    adult.survival.chance
    adult.body.size
    adult.body.shade
    adult.energy.supply
    adult.bite.capacity
    adult.mutation.chance
    adult.sex.ratio
    adult.litter.size
    adult.conception.chance
    adult.visual.angle
    adult.visual.range
    adult.day.perception
    adult.night.perception
    adult.yellow.chance
    adult.red.chance
    adult.blue.chance
    mother.initiated.birth
    mother.initiated.weaning
    
    lifetime-plant-abundance
    lifetime-plant-patchiness
    lifetime-population-size

  ))
  
  file-close

end

; --------------------------------------------------------------------------------------------------------- ;                                                           
;                                                                      
;   __ _   _ __    ___    _   _   _ __      ___    ___    __ _   _ __  
;  / _` | | '__|  / _ \  | | | | | '_ \    / __|  / __|  / _` | | '_ \ 
; | (_| | | |    | (_) | | |_| | | |_) |   \__ \ | (__  | (_| | | | | |
;  \__, | |_|     \___/   \__,_| | .__/    |___/  \___|  \__,_| |_| |_|
;  |___/                         |_|                                                     
; --------------------------------------------------------------------------------------------------------- ;

to scan-group [ group-id ]
  
  let file-path ( word path-to-experiment "group-scans-" population ".csv" )
  
  if ( not file-exists? file-path and simulation-id != 0 )
  
  [ file-open file-path
    file-print csv:to-string (list (list 
      
      "date-and-time"
      "path-to-experiment"
      "model-version"
      "model-structure"
      "genotype-reader"
      "simulation-id"
      "behaviorspace-experiment-name"
      "population" 
      "genotype"
      "plant-annual-cycle" 
      "plant-daily-cycle" 
      "plant-seasonality" 
      "plant-quality"
      "plant-minimum-neighbors" 
      "plant-maximum-neighbors" 
      "world-width" 
      "world-height"
      "output-results?" 
      "selection-on?" 
      "deterioration-rate"
      "maximum-visual-range"
      "base-litter-size"

      "current-timesteps"
      "current-solar-status"
      "current-season"
      "current-plant-patchiness"
      "current-plant-abundance"
      "current-population-density"
      "current-territory-size"
      
      "group-identity"
      "current-group-size" 
      "current-group-members"
      "current-territory-energy"
      
      "distance-to-centroid-minimum"
      "distance-to-centroid-maximum"
      "distance-to-centroid-mean"
      "distance-to-centroid-median"
      "distance-to-centroid-variance"
      
      "adult-male-count"
      "adult-cycling-count"
      "adult-pregnant-count"
      "adult-lactating-count"
      "juvenile-male-count"
      "juvenile-female-count"
      "infant-male-count"
      "infant-female-count"
      "gestatee-male-count"
      "gestatee-female-count"
      
      "total-birth-count"
      "total-death-count"
      "adult-male-death-count"
      "adult-cycling-death-count"
      "adult-pregnant-death-count"
      "adult-lactating-death-count"
      "juvenile-male-death-count"
      "juvenile-female-death-count"
      "infant-male-death-count"
      "infant-female-death-count"
      "gestatee-male-death-count"
      "gestatee-female-death-count"
      
      "per-capita-birth" 
      "per-capita-death"
      "per-capita-adult-male-death"
      "per-capita-adult-cycling-death"
      "per-capita-adult-pregnant-death"
      "per-capita-adult-lactating-death"
      "per-capita-juvenile-male-death"
      "per-capita-juvenile-female-death"
      "per-capita-infant-male-death"
      "per-capita-infant-female-death"
      "per-capita-gestatee-male-death"
      "per-capita-gestatee-female-death"
      
      "total-energy"
      "adult-male-energy"
      "adult-cycling-energy"
      "adult-pregnant-energy"
      "adult-lactating-energy"
      "juvenile-male-energy"
      "juvenile-female-energy"
      "infant-male-energy"
      "infant-female-energy"
      "gestatee-male-energy"
      "gestatee-female-energy"
      
      "per-capita-energy"
      "per-capita-adult-male-energy"
      "per-capita-adult-cycling-energy"
      "per-capita-adult-pregnant-energy"
      "per-capita-adult-lactating-energy"
      "per-capita-juvenile-male-energy"
      "per-capita-juvenile-female-energy"
      "per-capita-infant-male-energy"
      "per-capita-infant-female-energy"
      "per-capita-gestatee-male-energy"
      "per-capita-gestatee-female-energy" 
      
  )) ]
  
  file-open file-path
  
  let x-centroid mean [xcor] of living-agents with [ group.identity = group-id ]
  let y-centroid mean [ycor] of living-agents with [ group.identity = group-id ]
  let distance-list [ distancexy x-centroid y-centroid ] of living-agents with [ group.identity = group-id ]
  let distance-to-centroid-minimum ifelse-value ( length distance-list < 1 ) [ "NA" ] [ min distance-list ]
  let distance-to-centroid-maximum ifelse-value ( length distance-list < 1 ) [ "NA" ] [ max distance-list ] 
  let distance-to-centroid-mean ifelse-value ( length distance-list < 1 ) [ "NA" ] [ mean distance-list ]
  let distance-to-centroid-median ifelse-value ( length distance-list < 1 ) [ "NA" ] [ median distance-list ]
  let distance-to-centroid-variance ifelse-value ( length distance-list < 2 ) [ "NA" ] [ variance distance-list ] 
 
  let current-group-size count living-agents with [ group.identity = group-id ]
  let adult-male-count count living-agents with [ group.identity = group-id and life.history = "adult" and biological.sex = "male" ]
  let adult-cycling-count count living-agents with [ group.identity = group-id and life.history = "adult" and fertility.status = "cycling" ]
  let adult-pregnant-count count living-agents with [ group.identity = group-id and life.history = "adult" and fertility.status = "pregnant" ]
  let adult-lactating-count count living-agents with [ group.identity = group-id and life.history = "adult" and fertility.status = "lactating" ]
  let juvenile-male-count count living-agents with [ group.identity = group-id and life.history = "juvenile" and biological.sex = "male" ]
  let juvenile-female-count count living-agents with [ group.identity = group-id and life.history = "juvenile" and biological.sex = "female" ]
  let infant-male-count count living-agents with [ group.identity = group-id and life.history = "infant" and biological.sex = "male" ]
  let infant-female-count count living-agents with [ group.identity = group-id and life.history = "infant" and biological.sex = "female" ]
  let gestatee-male-count count living-agents with [ group.identity = group-id and life.history = "gestatee" and biological.sex = "male" ]
  let gestatee-female-count count living-agents with [ group.identity = group-id and life.history = "gestatee" and biological.sex = "female" ]
  
  let newly-born-agents anima1s with [ is.alive = true and ticks.at.birth <= ticks and ticks.at.birth > ( ticks - group-scan-ticks ) ]
  let total-birth-count count newly-born-agents with [ group.identity = group-id ]
  let dying-agents anima1s with [ is.alive = false and ticks.at.death <= ticks and ticks.at.death > ( ticks - group-scan-ticks ) ]
  let total-death-count count dying-agents with [ group.identity = group-id ]
  let adult-male-death-count count dying-agents with [ group.identity = group-id and life.history = "adult" and biological.sex = "male" ]
  let adult-cycling-death-count count dying-agents with [ group.identity = group-id and life.history = "adult" and fertility.status = "cycling" ]
  let adult-pregnant-death-count count dying-agents with [ group.identity = group-id and life.history = "adult" and fertility.status = "pregnant" ]
  let adult-lactating-death-count count dying-agents with [ group.identity = group-id and life.history = "adult" and fertility.status = "lactating" ]
  let juvenile-male-death-count count dying-agents with [ group.identity = group-id and life.history = "juvenile" and biological.sex = "male" ]
  let juvenile-female-death-count count dying-agents with [ group.identity = group-id and life.history = "juvenile" and biological.sex = "female" ]
  let infant-male-death-count count dying-agents with [ group.identity = group-id and life.history = "infant" and biological.sex = "male" ]
  let infant-female-death-count count dying-agents with [ group.identity = group-id and life.history = "infant" and biological.sex = "female" ]
  let gestatee-male-death-count count dying-agents with [ group.identity = group-id and life.history = "gestatee" and biological.sex = "male" ]
  let gestatee-female-death-count count dying-agents with [ group.identity = group-id and life.history = "gestatee" and biological.sex = "female" ]
  
  let total-energy sum [energy.supply] of living-agents with [ group.identity = group-id ]
  let adult-male-energy sum [energy.supply] of living-agents with [ group.identity = group-id and life.history = "adult" and biological.sex = "male" ]
  let adult-cycling-energy sum [energy.supply] of living-agents with [ group.identity = group-id and life.history = "adult" and fertility.status = "cycling" ]
  let adult-pregnant-energy sum [energy.supply] of living-agents with [ group.identity = group-id and life.history = "adult" and fertility.status = "pregnant" ]
  let adult-lactating-energy sum [energy.supply] of living-agents with [ group.identity = group-id and life.history = "adult" and fertility.status = "lactating" ]
  let juvenile-male-energy sum [energy.supply] of living-agents with [ group.identity = group-id and life.history = "juvenile" and biological.sex = "male" ]
  let juvenile-female-energy sum [energy.supply] of living-agents with [ group.identity = group-id and life.history = "juvenile" and biological.sex = "female" ]
  let infant-male-energy sum [energy.supply] of living-agents with [ group.identity = group-id and life.history = "infant" and biological.sex = "male" ]
  let infant-female-energy sum [energy.supply] of living-agents with [ group.identity = group-id and life.history = "infant" and biological.sex = "female" ]
  let gestatee-male-energy sum [energy.supply] of living-agents with [ group.identity = group-id and life.history = "gestatee" and biological.sex = "male" ]
  let gestatee-female-energy sum [energy.supply] of living-agents with [ group.identity = group-id and life.history = "gestatee" and biological.sex = "female" ]
  
  file-print csv:to-string ( list ( list
    
    date-and-time
    path-to-experiment
    model-version
    model-structure
    genotype-reader
    simulation-id
    behaviorspace-experiment-name
    population
    genotype
    plant-annual-cycle
    plant-daily-cycle
    plant-seasonality
    plant-quality
    plant-minimum-neighbors
    plant-maximum-neighbors
    world-width
    world-height
    output-results?
    selection-on?
    deterioration-rate
    maximum-visual-range
    base-litter-size
    
    ticks
    solar-status
    current-season
    plant-patchiness
    current-plant-abundance
    population-density
    count patches with [ pgroup.identity = group-id ]
        
    group-id
    current-group-size
    ([my.identity] of living-agents with [ group.identity = group-id ])
    (sum [penergy.supply] of patches with [ pgroup.identity = group-id ])
    
    distance-to-centroid-minimum
    distance-to-centroid-maximum
    distance-to-centroid-mean
    distance-to-centroid-median
    distance-to-centroid-variance

    adult-male-count
    adult-cycling-count
    adult-pregnant-count
    adult-lactating-count
    juvenile-male-count
    juvenile-female-count
    infant-male-count
    infant-female-count
    gestatee-male-count
    gestatee-female-count
    
    total-birth-count
    total-death-count
    adult-male-death-count
    adult-cycling-death-count
    adult-pregnant-death-count
    adult-lactating-death-count
    juvenile-male-death-count
    juvenile-female-death-count
    infant-male-death-count
    infant-female-death-count
    gestatee-male-death-count
    gestatee-female-death-count
    
    ifelse-value ( current-group-size > 0 ) [ ( total-birth-count / current-group-size) ] [ "NA" ]
    ifelse-value ( current-group-size > 0 ) [ ( total-death-count / current-group-size) ] [ "NA" ]
    ifelse-value ( adult-male-count > 0 ) [ (adult-male-death-count / adult-male-count) ] [ "NA" ]
    ifelse-value ( adult-cycling-count > 0 ) [ (adult-cycling-death-count / adult-cycling-count) ] [ "NA" ]
    ifelse-value ( adult-pregnant-count > 0 ) [ (adult-pregnant-death-count / adult-pregnant-count) ] [ "NA" ]
    ifelse-value ( adult-lactating-count > 0 ) [ (adult-lactating-death-count / adult-lactating-count) ] [ "NA" ]
    ifelse-value ( juvenile-male-count > 0 ) [ (juvenile-male-death-count / juvenile-male-count) ] [ "NA" ]
    ifelse-value ( juvenile-female-count > 0 ) [ (juvenile-female-death-count / juvenile-female-count) ] [ "NA" ]
    ifelse-value ( infant-male-count > 0 ) [ (infant-male-death-count / infant-male-count) ] [ "NA" ]
    ifelse-value ( infant-female-count > 0 ) [ (infant-female-death-count / infant-female-count) ] [ "NA" ]
    ifelse-value ( gestatee-male-count > 0 ) [ (gestatee-male-death-count / gestatee-male-count) ] [ "NA" ]
    ifelse-value ( gestatee-female-count > 0 ) [ (gestatee-female-death-count / gestatee-female-count) ] [ "NA" ]
    
    total-energy
    adult-male-energy
    adult-cycling-energy
    adult-pregnant-energy
    adult-lactating-energy
    juvenile-male-energy
    juvenile-female-energy
    infant-male-energy
    infant-female-energy
    gestatee-male-energy
    gestatee-female-energy
    
    ifelse-value ( current-group-size > 0 ) [ (total-energy / current-group-size) ] [ "NA" ]
    ifelse-value ( adult-male-count > 0 ) [ (adult-male-energy / adult-male-count) ] [ "NA" ]
    ifelse-value ( adult-cycling-count > 0 ) [ (adult-cycling-energy / adult-cycling-count) ] [ "NA" ]
    ifelse-value ( adult-pregnant-count > 0 ) [ (adult-pregnant-energy / adult-pregnant-count) ] [ "NA" ]
    ifelse-value ( adult-lactating-count > 0 ) [ (adult-lactating-energy / adult-lactating-count) ] [ "NA" ]
    ifelse-value ( juvenile-male-count > 0 ) [ (juvenile-male-energy / juvenile-male-count) ] [ "NA" ]
    ifelse-value ( juvenile-female-count > 0 ) [ (juvenile-female-energy / juvenile-female-count) ] [ "NA" ]
    ifelse-value ( infant-male-count > 0 ) [ (infant-male-energy / infant-male-count) ] [ "NA" ]
    ifelse-value ( infant-female-count > 0 ) [ (infant-female-energy / infant-female-count) ] [ "NA" ]
    ifelse-value ( gestatee-male-count > 0 ) [ (gestatee-male-energy / gestatee-male-count) ] [ "NA" ]
    ifelse-value ( gestatee-female-count > 0 ) [ (gestatee-female-energy / gestatee-female-count) ] [ "NA" ]
    
  ))
  
  file-close
  
end

; --------------------------------------------------------------------------------------------------------- ;
;        _                       _           _     _                                                
;  ___  (_)  _ __ ___    _   _  | |   __ _  | |_  (_)   ___    _ __      ___    ___    __ _   _ __  
; / __| | | | '_ ` _ \  | | | | | |  / _` | | __| | |  / _ \  | '_ \    / __|  / __|  / _` | | '_ \ 
; \__ \ | | | | | | | | | |_| | | | | (_| | | |_  | | | (_) | | | | |   \__ \ | (__  | (_| | | | | |
; |___/ |_| |_| |_| |_|  \__,_| |_|  \__,_|  \__| |_|  \___/  |_| |_|   |___/  \___|  \__,_| |_| |_|
;                                                                                                   
; --------------------------------------------------------------------------------------------------------- ;

to scan-simulation
  
  let file-path ( word path-to-experiment simulation-id "-scans.csv" )
  
  if ( not file-exists? file-path and simulation-id != 0 )
  
  [ file-open file-path
    file-print csv:to-string (list (list 
      
      "date-and-time"
      "path-to-experiment"
      "model-version"
      "model-structure"
      "genotype-reader"
      "simulation-id"
      "behaviorspace-experiment-name"
      "population" 
      "genotype"
      "plant-annual-cycle" 
      "plant-daily-cycle" 
      "plant-seasonality" 
      "plant-quality"
      "plant-minimum-neighbors" 
      "plant-maximum-neighbors" 
      "world-width" 
      "world-height"
      "output-results?" 
      "selection-on?" 
      "deterioration-rate"
      "maximum-visual-range"
      "base-litter-size"
      
      "timesteps"
      "solar-status"
      "current-season"
      "population-density"
      
      "current-plant-abundance"
      "current-plant-patchiness"
      "current-population-size"
      "generation-number-max"
      "generation-number-min"
      "generation-number-mean"
      "generation-number-median"
      "number-of-groups"
      "number-of-males"
      "number-of-females" 
      "number-of-adults" 
      "number-of-cycling-females" 
      "number-of-pregnant-females" 
      "number-of-lactating-females"
      "number-of-juveniles" 
      "number-of-infants"
      "number-of-gestatees" 
      "number-of-fully-alive-agents"
      "number-of-decaying-agents"
      "number-of-fully-decayed-agents"

  )) ]
  
  file-open file-path
  
  file-print csv:to-string ( list ( list
    
    date-and-time
    path-to-experiment
    model-version
    model-structure
    genotype-reader
    simulation-id
    behaviorspace-experiment-name
    population
    genotype
    plant-annual-cycle
    plant-daily-cycle
    plant-seasonality
    plant-quality
    plant-minimum-neighbors
    plant-maximum-neighbors
    world-width
    world-height
    output-results?
    selection-on?
    deterioration-rate
    maximum-visual-range
    base-litter-size
    
    ticks
    solar-status
    current-season
    population-density
    
    current-plant-abundance
    current-plant-patchiness
    current-population-size
    generation-number-max
    generation-number-min
    generation-number-mean
    generation-number-median
    
    number-of-groups
    number-of-males
    number-of-females
    number-of-adults
    number-of-cycling-females
    number-of-pregnant-females
    number-of-lactating-females
    number-of-juveniles
    number-of-infants
    number-of-gestatees
    number-of-fully-alive-agents
    number-of-decaying-agents
    number-of-fully-decayed-agents
    
  ))
  
  file-close

end

; ----------------------------------------------------------------------------------------------------------------------------------- ;
;        _                       _           _     _                                                                                
;  ___  (_)  _ __ ___    _   _  | |   __ _  | |_  (_)   ___    _ __      ___   _   _   _ __ ___    _ __ ___     __ _   _ __   _   _ 
; / __| | | | '_ ` _ \  | | | | | |  / _` | | __| | |  / _ \  | '_ \    / __| | | | | | '_ ` _ \  | '_ ` _ \   / _` | | '__| | | | |
; \__ \ | | | | | | | | | |_| | | | | (_| | | |_  | | | (_) | | | | |   \__ \ | |_| | | | | | | | | | | | | | | (_| | | |    | |_| |
; |___/ |_| |_| |_| |_|  \__,_| |_|  \__,_|  \__| |_|  \___/  |_| |_|   |___/  \__,_| |_| |_| |_| |_| |_| |_|  \__,_| |_|     \__, |
;                                                                                                                             |___/ 
;
; ----------------------------------------------------------------------------------------------------------------------------------- ;

to simulation-summary ; observer subroutine
  
  let simulations-file-path ( word path-to-experiment "simulations-" ticks ".csv" ) 
  
  if ( not file-exists? simulations-file-path and simulation-id != 0 )
  
  [ file-open simulations-file-path
    file-print csv:to-string (list (list 
      
      "path-to-experiment"
      "model-version"
      "model-structure"
      "genotype-reader"
      "simulation-id"
      "behaviorspace-experiment-name"
      "population" 
      "genotype"
      "plant-annual-cycle" 
      "plant-daily-cycle" 
      "plant-seasonality" 
      "plant-quality"
      "plant-minimum-neighbors" 
      "plant-maximum-neighbors" 
      "world-width" 
      "world-height"
      "output-results?" 
      "selection-on?" 
      "deterioration-rate"
      "maximum-visual-range"
      "base-litter-size"
      
      "start-date-and-time"
      "end-date-and-time"
      "simulation-duration-seconds"
      "simulation-duration-ticks"
      "population-went-extinct"
      "ticks-at-extinction"
      
      ; model validation and verification
      "verification-true-count"
      "verification-false-count"
      "verification-percent-true"
      
      "total-group-size-minimum"
      "total-group-size-maximum" 
      "total-group-size-mean" 
      "total-group-size-median" 
      "total-group-size-variance" 
      
      "adult-group-size-minimum"
      "adult-group-size-maximum" 
      "adult-group-size-mean" 
      "adult-group-size-median" 
      "adult-group-size-variance" 
      
      "groups-distance-to-centroid-minimum"
      "groups-distance-to-centroid-maximum"
      "groups-distance-to-centroid-mean"
      "groups-distance-to-centroid-median"
      "groups-distance-to-centroid-variance"
      
      "adult-males-who-disperse-count"
      "adult-males-who-not-disperse-count" 
      "adult-males-percent-disperse"
      "adult-females-who-disperse-count"
      "adult-females-who-not-disperse-count"
      "adult-females-percent-disperse" 
      
      "adult-males-multiple-mates-count" 
      "adult-males-single-mate-count" 
      "adult-males-no-mates-count" 
      "adult-males-percent-multiple-mates" 
      "adult-females-multiple-mates-count"
      "adult-females-single-mate-count" 
      "adult-females-no-mates-count" 
      "adult-females-percent-multiple-mates"
      
      ; emergent properties of plants
      "plant-abundance-maximum" 
      "plant-abundance-minimum" 
      "plant-abundance-mean" 
      "plant-abundance-variance" 
      "plant-patchiness-maximum" 
      "plant-patchiness-minimum" 
      "plant-patchiness-mean" 
      "plant-patchiness-variance" 
      
      ; population level 
      "generations-max"
      "generations-min"
      "generations-mean"
      "generations-median"
      "total-simulated-individuals"
      "total-simulated-males"
      "total-simulated-females"
      "total-simulated-adults"
      "population-size-maximum"
      "population-size-minimum"
      "population-size-mean"
      "population-size-variance"
      
      ; life history
      "gestation-length-maximum"
      "gestation-length-minimum"
      "gestation-length-mean"
      "gestation-length-variance"
      "lactation-length-maximum"
      "lactation-length-minimum"
      "lactation-length-mean"
      "lactation-length-variance"
      "juvenile-length-maximum"
      "juvenile-length-minimum"
      "juvenile-length-mean"
      "juvenile-length-variance"
      "male-age-at-first-reproduction-maximum"
      "male-age-at-first-reproduction-minimum"
      "male-age-at-first-reproduction-mean"
      "male-age-at-first-reproduction-variance"
      "female-age-at-first-reproduction-maximum"
      "female-age-at-first-reproduction-minimum"
      "female-age-at-first-reproduction-mean"
      "female-age-at-first-reproduction-variance"
      "male-adult-longevity-maximum"
      "male-adult-longevity-minimum"
      "male-adult-longevity-mean"
      "male-adult-longevity-variance"
      "female-adult-longevity-maximum"
      "female-adult-longevity-minimum"
      "female-adult-longevity-mean"
      "female-adult-longevity-variance"
      
      ; adult attributes
      "male-adult-hidden-chance-maximum"
      "male-adult-hidden-chance-minimum"
      "male-adult-hidden-chance-mean"
      "male-adult-hidden-chance-variance"
      "female-adult-hidden-chance-maximum"
      "female-adult-hidden-chance-minimum"
      "female-adult-hidden-chance-mean"
      "female-adult-hidden-chance-variance"
      "male-adult-survival-chance-maximum"
      "male-adult-survival-chance-minimum"
      "male-adult-survival-chance-mean"
      "male-adult-survival-chance-variance"
      "female-adult-survival-chance-maximum"
      "female-adult-survival-chance-minimum"
      "female-adult-survival-chance-mean"
      "female-adult-survival-chance-variance"
      "male-adult-body-size-maximum"
      "male-adult-body-size-minimum"
      "male-adult-body-size-mean"
      "male-adult-body-size-variance"
      "female-adult-body-size-maximum"
      "female-adult-body-size-minimum"
      "female-adult-body-size-mean"
      "female-adult-body-size-variance"
      "male-adult-body-shade-maximum"
      "male-adult-body-shade-minimum"
      "male-adult-body-shade-mean"
      "male-adult-body-shade-variance"
      "female-adult-body-shade-maximum"
      "female-adult-body-shade-minimum"
      "female-adult-body-shade-mean"
      "female-adult-body-shade-variance"
      "male-adult-energy-supply-maximum"
      "male-adult-energy-supply-minimum"
      "male-adult-energy-supply-mean"
      "male-adult-energy-supply-variance"
      "female-adult-energy-supply-maximum"
      "female-adult-energy-supply-minimum"
      "female-adult-energy-supply-mean"
      "female-adult-energy-supply-variance"
      "male-adult-bite-capacity-maximum"
      "male-adult-bite-capacity-minimum"
      "male-adult-bite-capacity-mean"
      "male-adult-bite-capacity-variance"
      "female-adult-bite-capacity-maximum"
      "female-adult-bite-capacity-minimum"
      "female-adult-bite-capacity-mean"
      "female-adult-bite-capacity-variance"
      "male-adult-mutation-chance-maximum"
      "male-adult-mutation-chance-minimum"
      "male-adult-mutation-chance-mean"
      "male-adult-mutation-chance-variance"
      "female-adult-mutation-chance-maximum"
      "female-adult-mutation-chance-minimum"
      "female-adult-mutation-chance-mean"
      "female-adult-mutation-chance-variance"
      "male-adult-sex-ratio-maximum"
      "male-adult-sex-ratio-minimum"
      "male-adult-sex-ratio-mean"
      "male-adult-sex-ratio-variance"
      "female-adult-sex-ratio-maximum"
      "female-adult-sex-ratio-minimum"
      "female-adult-sex-ratio-mean"
      "female-adult-sex-ratio-variance"
      "male-adult-litter-size-maximum"
      "male-adult-litter-size-minimum"
      "male-adult-litter-size-mean"
      "male-adult-litter-size-variance"
      "female-adult-litter-size-maximum"
      "female-adult-litter-size-minimum"
      "female-adult-litter-size-mean"
      "female-adult-litter-size-variance"
      "male-adult-conception-chance-maximum"
      "male-adult-conception-chance-minimum"
      "male-adult-conception-chance-mean"
      "male-adult-conception-chance-variance"
      "female-adult-conception-chance-maximum"
      "female-adult-conception-chance-minimum"
      "female-adult-conception-chance-mean"
      "female-adult-conception-chance-variance"
      "male-adult-visual-angle-maximum"
      "male-adult-visual-angle-minimum"
      "male-adult-visual-angle-mean"
      "male-adult-visual-angle-variance"
      "female-adult-visual-angle-maximum"
      "female-adult-visual-angle-minimum"
      "female-adult-visual-angle-mean"
      "female-adult-visual-angle-variance"
      "male-adult-visual-range-maximum"
      "male-adult-visual-range-minimum"
      "male-adult-visual-range-mean"
      "male-adult-visual-range-variance"
      "female-adult-visual-range-maximum"
      "female-adult-visual-range-minimum"
      "female-adult-visual-range-mean"
      "female-adult-visual-range-variance"
      "male-adult-day-perception-maximum"
      "male-adult-day-perception-minimum"
      "male-adult-day-perception-mean"
      "male-adult-day-perception-variance"
      "female-adult-day-perception-maximum"
      "female-adult-day-perception-minimum"
      "female-adult-day-perception-mean"
      "female-adult-day-perception-variance"
      "male-adult-night-perception-maximum"
      "male-adult-night-perception-minimum"
      "male-adult-night-perception-mean"
      "male-adult-night-perception-variance"
      "female-adult-night-perception-maximum"
      "female-adult-night-perception-minimum"
      "female-adult-night-perception-mean"
      "female-adult-night-perception-variance"
      
      ; behavior history
      "natal-group-size-maximum"
      "natal-group-size-minimum"
      "natal-group-size-mean"
      "natal-group-size-variance"
      "death-group-size-maximum"
      "death-group-size-minimum"
      "death-group-size-mean"
      "death-group-size-variance"
      "male-lifetime-distance-traveled-maximum"
      "male-lifetime-distance-traveled-minimum"
      "male-lifetime-distance-traveled-mean"
      "male-lifetime-distance-traveled-variance"
      "female-lifetime-distance-traveled-maximum"
      "female-lifetime-distance-traveled-minimum"
      "female-lifetime-distance-traveled-mean"
      "female-lifetime-distance-traveled-variance"
      "mother-initiated-birth-count"
      "offspring-initiated-birth-count"
      "mother-initiated-birth-percent"
      "mother-initiated-weaning-count"
      "offspring-initiated-weaning-count"
      "mother-initiated-weaning-percent"
      "male-lifetime-foraging-gains-maximum"  
      "male-lifetime-foraging-gains-minimum"
      "male-lifetime-foraging-gains-mean"
      "male-lifetime-foraging-gains-variance"
      "total-population-male-lifetime-foraging-gains"
      "female-lifetime-foraging-gains-maximum"
      "female-lifetime-foraging-gains-minimum"
      "female-lifetime-foraging-gains-mean"
      "female-lifetime-foraging-gains-variance"       
      "total-population-female-lifetime-foraging-gains"
      "male-lifetime-energy-gains-maximum"  
      "male-lifetime-energy-gains-minimum"
      "male-lifetime-energy-gains-mean"
      "male-lifetime-energy-gains-variance"       
      "total-population-male-lifetime-energy-gains"
      "female-lifetime-energy-gains-maximum"
      "female-lifetime-energy-gains-minimum"
      "female-lifetime-energy-gains-mean"
      "female-lifetime-energy-gains-variance"       
      "total-population-female-lifetime-energy-gains"
      "male-lifetime-energy-cost-maximum"  
      "male-lifetime-energy-cost-minimum"
      "male-lifetime-energy-cost-mean"
      "male-lifetime-energy-cost-variance"      
      "total-population-male-lifetime-energy-cost"
      "female-lifetime-energy-cost-maximum"
      "female-lifetime-energy-cost-minimum"
      "female-lifetime-energy-cost-mean"
      "female-lifetime-energy-cost-variance"       
      "total-population-female-lifetime-energy-cost"
      
      "male-lifetime-whole-related-help-cost-maximum"
      "male-lifetime-whole-related-help-cost-minimum"
      "male-lifetime-whole-related-help-cost-mean"
      "male-lifetime-whole-related-help-cost-variance"       
      "total-population-male-lifetime-whole-related-help-cost"
      "female-lifetime-whole-related-help-cost-maximum"
      "female-lifetime-whole-related-help-cost-minimum"
      "female-lifetime-whole-related-help-cost-mean"
      "female-lifetime-whole-related-help-cost-variance"       
      "total-population-female-lifetime-whole-related-help-cost"
      "male-lifetime-half-related-help-cost-maximum"
      "male-lifetime-half-related-help-cost-minimum"
      "male-lifetime-half-related-help-cost-mean"
      "male-lifetime-half-related-help-cost-variance"       
      "total-population-male-lifetime-half-related-help-cost"
      "female-lifetime-half-related-help-cost-maximum"
      "female-lifetime-half-related-help-cost-minimum"
      "female-lifetime-half-related-help-cost-mean"
      "female-lifetime-half-related-help-cost-variance"       
      "total-population-female-lifetime-half-related-help-cost"
      "male-lifetime-fourth-related-help-cost-maximum"
      "male-lifetime-fourth-related-help-cost-minimum"
      "male-lifetime-fourth-related-help-cost-mean"
      "male-lifetime-fourth-related-help-cost-variance"       
      "total-population-male-lifetime-fourth-related-help-cost"
      "female-lifetime-fourth-related-help-cost-maximum"
      "female-lifetime-fourth-related-help-cost-minimum"
      "female-lifetime-fourth-related-help-cost-mean"
      "female-lifetime-fourth-related-help-cost-variance"       
      "total-population-female-lifetime-fourth-related-help-cost"
      "male-lifetime-eighth-related-help-cost-maximum"
      "male-lifetime-eighth-related-help-cost-minimum"
      "male-lifetime-eighth-related-help-cost-mean"
      "male-lifetime-eighth-related-help-cost-variance"       
      "total-population-male-lifetime-eighth-related-help-cost"
      "female-lifetime-eighth-related-help-cost-maximum"
      "female-lifetime-eighth-related-help-cost-minimum"
      "female-lifetime-eighth-related-help-cost-mean"
      "female-lifetime-eighth-related-help-cost-variance"       
      "total-population-female-lifetime-eighth-related-help-cost"
      "male-lifetime-not-related-help-cost-maximum"
      "male-lifetime-not-related-help-cost-minimum"
      "male-lifetime-not-related-help-cost-mean"
      "male-lifetime-not-related-help-cost-variance"       
      "total-population-male-lifetime-not-related-help-cost"
      "female-lifetime-not-related-help-cost-maximum"
      "female-lifetime-not-related-help-cost-minimum"
      "female-lifetime-not-related-help-cost-mean"
      "female-lifetime-not-related-help-cost-variance"       
      "total-population-female-lifetime-not-related-help-cost"
      "male-lifetime-whole-related-attack-cost-maximum"
      "male-lifetime-whole-related-attack-cost-minimum"
      "male-lifetime-whole-related-attack-cost-mean"
      "male-lifetime-whole-related-attack-cost-variance"       
      "total-population-male-lifetime-whole-related-attack-cost"
      "female-lifetime-whole-related-attack-cost-maximum"
      "female-lifetime-whole-related-attack-cost-minimum"
      "female-lifetime-whole-related-attack-cost-mean"
      "female-lifetime-whole-related-attack-cost-variance"       
      "total-population-female-lifetime-whole-related-attack-cost"
      "male-lifetime-half-related-attack-cost-maximum"
      "male-lifetime-half-related-attack-cost-minimum"
      "male-lifetime-half-related-attack-cost-mean"
      "male-lifetime-half-related-attack-cost-variance"       
      "total-population-male-lifetime-half-related-attack-cost"
      "female-lifetime-half-related-attack-cost-maximum"
      "female-lifetime-half-related-attack-cost-minimum"
      "female-lifetime-half-related-attack-cost-mean"
      "female-lifetime-half-related-attack-cost-variance"       
      "total-population-female-lifetime-half-related-attack-cost"
      "male-lifetime-fourth-related-attack-cost-maximum"
      "male-lifetime-fourth-related-attack-cost-minimum"
      "male-lifetime-fourth-related-attack-cost-mean"
      "male-lifetime-fourth-related-attack-cost-variance"       
      "total-population-male-lifetime-fourth-related-attack-cost"
      "female-lifetime-fourth-related-attack-cost-maximum"
      "female-lifetime-fourth-related-attack-cost-minimum"
      "female-lifetime-fourth-related-attack-cost-mean"
      "female-lifetime-fourth-related-attack-cost-variance"       
      "total-population-female-lifetime-fourth-related-attack-cost"
      "male-lifetime-eighth-related-attack-cost-maximum"
      "male-lifetime-eighth-related-attack-cost-minimum"
      "male-lifetime-eighth-related-attack-cost-mean"
      "male-lifetime-eighth-related-attack-cost-variance"       
      "total-population-male-lifetime-eighth-related-attack-cost"
      "female-lifetime-eighth-related-attack-cost-maximum"
      "female-lifetime-eighth-related-attack-cost-minimum"
      "female-lifetime-eighth-related-attack-cost-mean"
      "female-lifetime-eighth-related-attack-cost-variance"       
      "total-population-female-lifetime-eighth-related-attack-cost"
      "male-lifetime-not-related-attack-cost-maximum"
      "male-lifetime-not-related-attack-cost-minimum"
      "male-lifetime-not-related-attack-cost-mean"
      "male-lifetime-not-related-attack-cost-variance"       
      "total-population-male-lifetime-not-related-attack-cost"
      "female-lifetime-not-related-attack-cost-maximum"
      "female-lifetime-not-related-attack-cost-minimum"
      "female-lifetime-not-related-attack-cost-mean"
      "female-lifetime-not-related-attack-cost-variance"       
      "total-population-female-lifetime-not-related-attack-cost"
      
      "male-total-help-from-count-maximum"
      "male-total-help-from-count-minimum"
      "male-total-help-from-count-mean"
      "male-total-help-from-count-variance"       
      "total-population-male-total-help-from-count"
      "female-total-help-from-count-maximum"
      "female-total-help-from-count-minimum"
      "female-total-help-from-count-mean"
      "female-total-help-from-count-variance"       
      "total-population-female-total-help-from-count"
      "male-total-attack-from-count-maximum"
      "male-total-attack-from-count-minimum"
      "male-total-attack-from-count-mean"
      "male-total-attack-from-count-variance"       
      "total-population-male-total-attack-from-count"
      "female-total-attack-from-count-maximum"
      "female-total-attack-from-count-minimum"
      "female-total-attack-from-count-mean"
      "female-total-attack-from-count-variance"       
      "total-population-female-total-attack-from-count"
      "male-total-matings-maximum"
      "male-total-matings-minimum"
      "male-total-matings-mean"
      "male-total-matings-variance"       
      "total-population-male-total-matings"
      "male-unique-female-matings-maximum"
      "male-unique-female-matings-minimum"
      "male-unique-female-matings-mean"
      "male-unique-female-matings-variance"       
      "total-population-male-unique-female-matings"
      "female-total-matings-maximum"
      "female-total-matings-minimum"
      "female-total-matings-mean"
      "female-total-matings-variance"       
      "total-population-female-total-matings"
      "female-unique-male-matings-maximum"
      "female-unique-male-matings-minimum"
      "female-unique-male-matings-mean"
      "female-unique-male-matings-variance"       
      "total-population-female-unique-male-matings"
      "male-total-group-transfers-maximum"
      "male-total-group-transfers-minimum"
      "male-total-group-transfers-mean"
      "male-total-group-transfers-variance"       
      "total-population-male-total-group-transfers"
      "female-total-group-transfers-maximum"
      "female-total-group-transfers-minimum"
      "female-total-group-transfers-mean"
      "female-total-group-transfers-variance"      
      "total-population-female-total-group-transfers"
      "male-infanticide-count-maximum"
      "male-infanticide-count-minimum"
      "male-infanticide-count-mean"
      "male-infanticide-count-variance"       
      "total-population-male-infanticide-count"
      "female-infanticide-count-maximum"
      "female-infanticide-count-minimum"
      "female-infanticide-count-mean"
      "female-infanticide-count-variance"       
      "total-population-female-infanticide-count"
      
  )) ]
  
  file-open simulations-file-path
  
  file-print csv:to-string ( list ( list
    
    path-to-experiment
    model-version
    model-structure
    genotype-reader
    simulation-id
    behaviorspace-experiment-name
    population
    genotype
    plant-annual-cycle
    plant-daily-cycle
    plant-seasonality
    plant-quality
    plant-minimum-neighbors
    plant-maximum-neighbors
    world-width
    world-height
    output-results?
    selection-on?
    deterioration-rate
    maximum-visual-range
    base-litter-size
    
    start-date-and-time
    end-date-and-time
    simulation-duration-seconds
    ticks
    population-went-extinct
    ticks-at-extinction
    
    ; model validation and verification
    verification-true-count
    verification-false-count
    verification-percent-true
    
    total-group-size-minimum 
    total-group-size-maximum 
    total-group-size-mean 
    total-group-size-median 
    total-group-size-variance 
    
    adult-group-size-minimum 
    adult-group-size-maximum 
    adult-group-size-mean 
    adult-group-size-median 
    adult-group-size-variance 
    
    groups-distance-to-centroid-minimum
    groups-distance-to-centroid-maximum
    groups-distance-to-centroid-mean
    groups-distance-to-centroid-median
    groups-distance-to-centroid-variance
    
    adult-males-who-disperse-count
    adult-males-who-not-disperse-count 
    adult-males-percent-disperse
    adult-females-who-disperse-count
    adult-females-who-not-disperse-count
    adult-females-percent-disperse 

    adult-males-multiple-mates-count 
    adult-males-single-mate-count 
    adult-males-no-mates-count
    adult-males-percent-multiple-mates 
    adult-females-multiple-mates-count
    adult-females-single-mate-count
    adult-females-no-mates-count
    adult-females-percent-multiple-mates
    
    ; emergent properties of plants
    plant-abundance-maximum 
    plant-abundance-minimum 
    plant-abundance-mean 
    plant-abundance-variance 
    plant-patchiness-maximum 
    plant-patchiness-minimum 
    plant-patchiness-mean 
    plant-patchiness-variance 
    
    ; population level 
    generation-number-max
    generation-number-min
    generation-number-mean
    generation-number-median
    total-simulated-individuals
    total-simulated-males
    total-simulated-females
    total-simulated-adults
    population-size-maximum
    population-size-minimum
    population-size-mean
    population-size-variance
    
    ; life history
    gestation-length-maximum
    gestation-length-minimum
    gestation-length-mean
    gestation-length-variance
    lactation-length-maximum
    lactation-length-minimum
    lactation-length-mean
    lactation-length-variance
    juvenile-length-maximum
    juvenile-length-minimum
    juvenile-length-mean
    juvenile-length-variance
    male-age-at-first-reproduction-maximum
    male-age-at-first-reproduction-minimum
    male-age-at-first-reproduction-mean
    male-age-at-first-reproduction-variance
    female-age-at-first-reproduction-maximum
    female-age-at-first-reproduction-minimum
    female-age-at-first-reproduction-mean
    female-age-at-first-reproduction-variance
    male-adult-longevity-maximum
    male-adult-longevity-minimum
    male-adult-longevity-mean
    male-adult-longevity-variance
    female-adult-longevity-maximum
    female-adult-longevity-minimum
    female-adult-longevity-mean
    female-adult-longevity-variance
    
    ; adult attributes
    male-adult-hidden-chance-maximum
    male-adult-hidden-chance-minimum
    male-adult-hidden-chance-mean
    male-adult-hidden-chance-variance
    female-adult-hidden-chance-maximum
    female-adult-hidden-chance-minimum
    female-adult-hidden-chance-mean
    female-adult-hidden-chance-variance
    male-adult-survival-chance-maximum
    male-adult-survival-chance-minimum
    male-adult-survival-chance-mean
    male-adult-survival-chance-variance
    female-adult-survival-chance-maximum
    female-adult-survival-chance-minimum
    female-adult-survival-chance-mean
    female-adult-survival-chance-variance
    male-adult-body-size-maximum
    male-adult-body-size-minimum
    male-adult-body-size-mean
    male-adult-body-size-variance
    female-adult-body-size-maximum
    female-adult-body-size-minimum
    female-adult-body-size-mean
    female-adult-body-size-variance
    male-adult-body-shade-maximum
    male-adult-body-shade-minimum
    male-adult-body-shade-mean
    male-adult-body-shade-variance
    female-adult-body-shade-maximum
    female-adult-body-shade-minimum
    female-adult-body-shade-mean
    female-adult-body-shade-variance
    male-adult-energy-supply-maximum
    male-adult-energy-supply-minimum
    male-adult-energy-supply-mean
    male-adult-energy-supply-variance
    female-adult-energy-supply-maximum
    female-adult-energy-supply-minimum
    female-adult-energy-supply-mean
    female-adult-energy-supply-variance
    male-adult-bite-capacity-maximum
    male-adult-bite-capacity-minimum
    male-adult-bite-capacity-mean
    male-adult-bite-capacity-variance
    female-adult-bite-capacity-maximum
    female-adult-bite-capacity-minimum
    female-adult-bite-capacity-mean
    female-adult-bite-capacity-variance
    male-adult-mutation-chance-maximum
    male-adult-mutation-chance-minimum
    male-adult-mutation-chance-mean
    male-adult-mutation-chance-variance
    female-adult-mutation-chance-maximum
    female-adult-mutation-chance-minimum
    female-adult-mutation-chance-mean
    female-adult-mutation-chance-variance
    male-adult-sex-ratio-maximum
    male-adult-sex-ratio-minimum
    male-adult-sex-ratio-mean
    male-adult-sex-ratio-variance
    female-adult-sex-ratio-maximum
    female-adult-sex-ratio-minimum
    female-adult-sex-ratio-mean
    female-adult-sex-ratio-variance
    male-adult-litter-size-maximum
    male-adult-litter-size-minimum
    male-adult-litter-size-mean
    male-adult-litter-size-variance
    female-adult-litter-size-maximum
    female-adult-litter-size-minimum
    female-adult-litter-size-mean
    female-adult-litter-size-variance
    male-adult-conception-chance-maximum
    male-adult-conception-chance-minimum
    male-adult-conception-chance-mean
    male-adult-conception-chance-variance
    female-adult-conception-chance-maximum
    female-adult-conception-chance-minimum
    female-adult-conception-chance-mean
    female-adult-conception-chance-variance
    male-adult-visual-angle-maximum
    male-adult-visual-angle-minimum
    male-adult-visual-angle-mean
    male-adult-visual-angle-variance
    female-adult-visual-angle-maximum
    female-adult-visual-angle-minimum
    female-adult-visual-angle-mean
    female-adult-visual-angle-variance
    male-adult-visual-range-maximum
    male-adult-visual-range-minimum
    male-adult-visual-range-mean
    male-adult-visual-range-variance
    female-adult-visual-range-maximum
    female-adult-visual-range-minimum
    female-adult-visual-range-mean
    female-adult-visual-range-variance
    male-adult-day-perception-maximum
    male-adult-day-perception-minimum
    male-adult-day-perception-mean
    male-adult-day-perception-variance
    female-adult-day-perception-maximum
    female-adult-day-perception-minimum
    female-adult-day-perception-mean
    female-adult-day-perception-variance
    male-adult-night-perception-maximum
    male-adult-night-perception-minimum
    male-adult-night-perception-mean
    male-adult-night-perception-variance
    female-adult-night-perception-maximum
    female-adult-night-perception-minimum
    female-adult-night-perception-mean
    female-adult-night-perception-variance
    
    ; behavior history
    natal-group-size-maximum
    natal-group-size-minimum
    natal-group-size-mean
    natal-group-size-variance
    death-group-size-maximum
    death-group-size-minimum
    death-group-size-mean
    death-group-size-variance
    male-lifetime-distance-traveled-maximum
    male-lifetime-distance-traveled-minimum
    male-lifetime-distance-traveled-mean
    male-lifetime-distance-traveled-variance
    female-lifetime-distance-traveled-maximum
    female-lifetime-distance-traveled-minimum
    female-lifetime-distance-traveled-mean
    female-lifetime-distance-traveled-variance
    mother-initiated-birth-count
    offspring-initiated-birth-count
    mother-initiated-birth-percent
    mother-initiated-weaning-count
    offspring-initiated-weaning-count
    mother-initiated-weaning-percent
    male-lifetime-foraging-gains-maximum  
    male-lifetime-foraging-gains-minimum
    male-lifetime-foraging-gains-mean
    male-lifetime-foraging-gains-variance       
    total-population-male-lifetime-foraging-gains
    female-lifetime-foraging-gains-maximum
    female-lifetime-foraging-gains-minimum
    female-lifetime-foraging-gains-mean
    female-lifetime-foraging-gains-variance       
    total-population-female-lifetime-foraging-gains
    male-lifetime-energy-gains-maximum  
    male-lifetime-energy-gains-minimum
    male-lifetime-energy-gains-mean
    male-lifetime-energy-gains-variance       
    total-population-male-lifetime-energy-gains
    female-lifetime-energy-gains-maximum
    female-lifetime-energy-gains-minimum
    female-lifetime-energy-gains-mean
    female-lifetime-energy-gains-variance       
    total-population-female-lifetime-energy-gains
    male-lifetime-energy-cost-maximum  
    male-lifetime-energy-cost-minimum
    male-lifetime-energy-cost-mean
    male-lifetime-energy-cost-variance       
    total-population-male-lifetime-energy-cost
    female-lifetime-energy-cost-maximum
    female-lifetime-energy-cost-minimum
    female-lifetime-energy-cost-mean
    female-lifetime-energy-cost-variance       
    total-population-female-lifetime-energy-cost
    
    male-lifetime-whole-related-help-cost-maximum
    male-lifetime-whole-related-help-cost-minimum
    male-lifetime-whole-related-help-cost-mean
    male-lifetime-whole-related-help-cost-variance       
    total-population-male-lifetime-whole-related-help-cost
    female-lifetime-whole-related-help-cost-maximum
    female-lifetime-whole-related-help-cost-minimum
    female-lifetime-whole-related-help-cost-mean
    female-lifetime-whole-related-help-cost-variance       
    total-population-female-lifetime-whole-related-help-cost
    male-lifetime-half-related-help-cost-maximum
    male-lifetime-half-related-help-cost-minimum
    male-lifetime-half-related-help-cost-mean
    male-lifetime-half-related-help-cost-variance       
    total-population-male-lifetime-half-related-help-cost
    female-lifetime-half-related-help-cost-maximum
    female-lifetime-half-related-help-cost-minimum
    female-lifetime-half-related-help-cost-mean
    female-lifetime-half-related-help-cost-variance       
    total-population-female-lifetime-half-related-help-cost
    male-lifetime-fourth-related-help-cost-maximum
    male-lifetime-fourth-related-help-cost-minimum
    male-lifetime-fourth-related-help-cost-mean
    male-lifetime-fourth-related-help-cost-variance       
    total-population-male-lifetime-fourth-related-help-cost
    female-lifetime-fourth-related-help-cost-maximum
    female-lifetime-fourth-related-help-cost-minimum
    female-lifetime-fourth-related-help-cost-mean
    female-lifetime-fourth-related-help-cost-variance       
    total-population-female-lifetime-fourth-related-help-cost
    male-lifetime-eighth-related-help-cost-maximum
    male-lifetime-eighth-related-help-cost-minimum
    male-lifetime-eighth-related-help-cost-mean
    male-lifetime-eighth-related-help-cost-variance       
    total-population-male-lifetime-eighth-related-help-cost
    female-lifetime-eighth-related-help-cost-maximum
    female-lifetime-eighth-related-help-cost-minimum
    female-lifetime-eighth-related-help-cost-mean
    female-lifetime-eighth-related-help-cost-variance       
    total-population-female-lifetime-eighth-related-help-cost
    male-lifetime-not-related-help-cost-maximum
    male-lifetime-not-related-help-cost-minimum
    male-lifetime-not-related-help-cost-mean
    male-lifetime-not-related-help-cost-variance       
    total-population-male-lifetime-not-related-help-cost
    female-lifetime-not-related-help-cost-maximum
    female-lifetime-not-related-help-cost-minimum
    female-lifetime-not-related-help-cost-mean
    female-lifetime-not-related-help-cost-variance       
    total-population-female-lifetime-not-related-help-cost
    male-lifetime-whole-related-attack-cost-maximum
    male-lifetime-whole-related-attack-cost-minimum
    male-lifetime-whole-related-attack-cost-mean
    male-lifetime-whole-related-attack-cost-variance       
    total-population-male-lifetime-whole-related-attack-cost
    female-lifetime-whole-related-attack-cost-maximum
    female-lifetime-whole-related-attack-cost-minimum
    female-lifetime-whole-related-attack-cost-mean
    female-lifetime-whole-related-attack-cost-variance       
    total-population-female-lifetime-whole-related-attack-cost
    male-lifetime-half-related-attack-cost-maximum
    male-lifetime-half-related-attack-cost-minimum
    male-lifetime-half-related-attack-cost-mean
    male-lifetime-half-related-attack-cost-variance       
    total-population-male-lifetime-half-related-attack-cost
    female-lifetime-half-related-attack-cost-maximum
    female-lifetime-half-related-attack-cost-minimum
    female-lifetime-half-related-attack-cost-mean
    female-lifetime-half-related-attack-cost-variance       
    total-population-female-lifetime-half-related-attack-cost
    male-lifetime-fourth-related-attack-cost-maximum
    male-lifetime-fourth-related-attack-cost-minimum
    male-lifetime-fourth-related-attack-cost-mean
    male-lifetime-fourth-related-attack-cost-variance       
    total-population-male-lifetime-fourth-related-attack-cost
    female-lifetime-fourth-related-attack-cost-maximum
    female-lifetime-fourth-related-attack-cost-minimum
    female-lifetime-fourth-related-attack-cost-mean
    female-lifetime-fourth-related-attack-cost-variance       
    total-population-female-lifetime-fourth-related-attack-cost
    male-lifetime-eighth-related-attack-cost-maximum
    male-lifetime-eighth-related-attack-cost-minimum
    male-lifetime-eighth-related-attack-cost-mean
    male-lifetime-eighth-related-attack-cost-variance       
    total-population-male-lifetime-eighth-related-attack-cost
    female-lifetime-eighth-related-attack-cost-maximum
    female-lifetime-eighth-related-attack-cost-minimum
    female-lifetime-eighth-related-attack-cost-mean
    female-lifetime-eighth-related-attack-cost-variance       
    total-population-female-lifetime-eighth-related-attack-cost
    male-lifetime-not-related-attack-cost-maximum
    male-lifetime-not-related-attack-cost-minimum
    male-lifetime-not-related-attack-cost-mean
    male-lifetime-not-related-attack-cost-variance       
    total-population-male-lifetime-not-related-attack-cost
    female-lifetime-not-related-attack-cost-maximum
    female-lifetime-not-related-attack-cost-minimum
    female-lifetime-not-related-attack-cost-mean
    female-lifetime-not-related-attack-cost-variance       
    total-population-female-lifetime-not-related-attack-cost
    
    male-total-help-from-count-maximum
    male-total-help-from-count-minimum
    male-total-help-from-count-mean
    male-total-help-from-count-variance       
    total-population-male-total-help-from-count
    female-total-help-from-count-maximum
    female-total-help-from-count-minimum
    female-total-help-from-count-mean
    female-total-help-from-count-variance       
    total-population-female-total-help-from-count
    male-total-attack-from-count-maximum
    male-total-attack-from-count-minimum
    male-total-attack-from-count-mean
    male-total-attack-from-count-variance       
    total-population-male-total-attack-from-count
    female-total-attack-from-count-maximum
    female-total-attack-from-count-minimum
    female-total-attack-from-count-mean
    female-total-attack-from-count-variance       
    total-population-female-total-attack-from-count
    male-total-matings-maximum
    male-total-matings-minimum
    male-total-matings-mean
    male-total-matings-variance       
    total-population-male-total-matings
    male-unique-female-matings-maximum
    male-unique-female-matings-minimum
    male-unique-female-matings-mean
    male-unique-female-matings-variance       
    total-population-male-unique-female-matings
    female-total-matings-maximum
    female-total-matings-minimum
    female-total-matings-mean
    female-total-matings-variance       
    total-population-female-total-matings
    female-unique-male-matings-maximum
    female-unique-male-matings-minimum
    female-unique-male-matings-mean
    female-unique-male-matings-variance       
    total-population-female-unique-male-matings
    male-total-group-transfers-maximum
    male-total-group-transfers-minimum
    male-total-group-transfers-mean
    male-total-group-transfers-variance       
    total-population-male-total-group-transfers
    female-total-group-transfers-maximum
    female-total-group-transfers-minimum
    female-total-group-transfers-mean
    female-total-group-transfers-variance       
    total-population-female-total-group-transfers
    male-infanticide-count-maximum
    male-infanticide-count-minimum
    male-infanticide-count-mean
    male-infanticide-count-variance       
    total-population-male-infanticide-count
    female-infanticide-count-maximum
    female-infanticide-count-minimum
    female-infanticide-count-mean
    female-infanticide-count-variance       
    total-population-female-infanticide-count
    
  ))
  
  file-close

end

;--------------------------------------------------------------------------------------------------------------------
; AGENT FUNCTIONS
;--------------------------------------------------------------------------------------------------------------------

to-report focal-subject report self = subject end
to-report help-from-count report length help.from.history end
to-report attack-from-count report length attack.from.history end
to-report copulations-count report length copulations.history end
to-report unique-mates-count report length remove-duplicates copulations.history end
to-report conceptions-count report length conceptions.history end
to-report group-transfers-count report length group.transfers.history end

to-report infanticide-count 
  let current-infanticide-history filter [ i -> any? anima1s with [ not is.alive and my.identity = i ] ] remove-duplicates infanticide.history   ; must remove individual infants who are still alive at the time of this individual's death ; only count ids from dead anima1s
  report length current-infanticide-history
end

to-report gestation-duration report ifelse-value ( ticks.at.birth = 0 ) [ 0 ] [ ( ticks.at.birth - ticks.at.conception ) ] end
to-report lactation-duration report ifelse-value ( ticks.at.weaning = 0 or ticks.at.birth = 0 ) [ 0 ] [ ( ticks.at.weaning - ticks.at.birth ) ] end
to-report juvenile-duration report ifelse-value ( ticks.at.sexual.maturity = 0 or ticks.at.weaning = 0 ) [ 0 ] [ ( ticks.at.sexual.maturity - ticks.at.weaning ) ] end
to-report lifespan report ( ticks.at.death - ticks.at.conception ) end

  ; defensive programming needed here
to-report lifetime-plant-abundance report mean sublist plant-abundance-record ( length plant-abundance-record - how-many-records ) ( length plant-abundance-record )  end
to-report lifetime-plant-patchiness report mean sublist plant-patchiness-record  ( length plant-patchiness-record  - how-many-records ) ( length plant-patchiness-record  ) end
to-report lifetime-population-size report mean sublist population-size-record ( length population-size-record - how-many-records ) ( length population-size-record ) end
  
to-report how-many-records report ceiling (( ticks.at.death - ticks.at.conception ) / timestep-interval ) end
  
;--------------------------------------------------------------------------------------------------------------------
; OBSERVER FUNCTIONS
;--------------------------------------------------------------------------------------------------------------------
  
to-report living-agents report anima1s with [ is.alive ] end
to-report decayed-agents report anima1s with [ fully.decayed and generation.number > 0 ] end
  
to-report plant-patchiness
  let patch-diameter 2 * maximum-visual-range          ; Patch size is set to visual diameter
  let patch-list []
  
  let i 0
  let j 0
  let i-next patch-diameter
  let j-next patch-diameter
  
  while [ j < world-height ] [
    while [ i < world-width ] [
      
      set patch-list lput sum [ penergy.supply ] of patches with [ pxcor > i and pxcor <= i-next and pycor > j and pycor <= j-next ] patch-list
      set i i-next
      set i-next ifelse-value (( i + patch-diameter ) > world-width ) [ world-width ] [ i + patch-diameter ] ]
    
    set i 0
    set i-next patch-diameter
    set j j-next
    set j-next ifelse-value (( j + patch-diameter ) > world-height ) [ world-height ] [ j + patch-diameter ] ]
  
  report ifelse-value ( mean patch-list = 0 ) [ 0 ] [ ( variance patch-list / mean patch-list ) ]
end

to-report population-density report count anima1s with [ is.alive ] / ( world-width * world-height ) end
to-report current-plant-abundance report sum [ penergy.supply ] of patches end
to-report current-plant-patchiness report plant-patchiness end
to-report current-population-size report count anima1s with [ is.alive ] end
to-report generation-number-max report ifelse-value ( any? living-agents ) [ max [ generation.number ] of living-agents ] [ "NA" ] end
to-report generation-number-min report ifelse-value ( any? living-agents ) [ min [ generation.number ] of living-agents ] [ "NA" ] end
to-report generation-number-mean report ifelse-value ( any? living-agents ) [ mean [ generation.number ] of living-agents ] [ "NA" ] end
to-report generation-number-median report ifelse-value ( any? living-agents ) [ median [ generation.number ] of living-agents ] [ "NA" ] end
to-report number-of-females report count anima1s with [ is.alive and biological.sex = "female" ] end
to-report number-of-males report count anima1s with [ is.alive and biological.sex = "male" ] end
to-report number-of-gestatees report count anima1s with [ is.alive and life.history = "gestatee" ] end
to-report number-of-infants report count anima1s with [ is.alive and life.history = "infant" ] end
to-report number-of-juveniles report count anima1s with [ is.alive and life.history = "juvenile" ] end
to-report number-of-adults report count anima1s with [ is.alive and life.history = "adult" ] end
to-report number-of-cycling-females report count anima1s with [ is.alive and fertility.status = "cycling" ] end
to-report number-of-pregnant-females report count anima1s with [ is.alive and fertility.status = "pregnant" ] end
to-report number-of-lactating-females report count anima1s with [ is.alive and fertility.status = "lactating" ] end
to-report number-of-fully-alive-agents report count anima1s with [ is.alive ] end
to-report number-of-decaying-agents report count anima1s with [ is.alive = false and fully.decayed = false ] end
to-report number-of-fully-decayed-agents report count anima1s with [ fully.decayed ] end
to-report number-of-groups report length remove-duplicates [ group.identity ] of anima1s with [ is.alive and count anima1s with [ is.alive and group.identity = [group.identity] of myself ] > 1 ] end

  ; simulation parameters and settings
to-report end-date-and-time report date-and-time end
to-report simulation-duration-seconds report timer end
to-report simulation-duration-ticks report ticks end
to-report population-went-extinct report ifelse-value ( not any? anima1s with [ is.alive ] ) [ true ] [ false ] end
to-report ticks-at-extinction report ifelse-value ( any? anima1s ) [ ifelse-value ( any? living-agents ) [ "NA" ] [ max [ ticks.at.death ] of anima1s ]] [ "NA" ] end
  
  ; model validation and verification
to-report verification-true-count report length filter [ i -> i = true ] verification-results end
to-report verification-false-count report length filter [ i -> i = false ] verification-results end
to-report verification-percent-true report ifelse-value ( verification-true-count + verification-false-count = 0 ) [ "NA" ] [ verification-true-count / ( verification-true-count + verification-false-count ) ] end
  
to-report group-sizes report filter [ j -> j > 1 ] map [ i -> count living-agents with [ group.identity = i ]] remove-duplicates [group.identity] of living-agents end
to-report total-group-size-minimum report ifelse-value ( length group-sizes < 1 ) [ "NA" ] [ min group-sizes ] end
to-report total-group-size-maximum report ifelse-value ( length group-sizes < 1 ) [ "NA" ] [ max group-sizes ]  end
to-report total-group-size-mean report ifelse-value ( length group-sizes < 1 ) [ "NA" ] [ mean group-sizes ]  end
to-report total-group-size-median report ifelse-value ( length group-sizes < 1 ) [ "NA" ] [ median group-sizes ] end
to-report total-group-size-variance report ifelse-value ( length group-sizes < 2 ) [ "NA" ] [ variance group-sizes ]  end
  
to-report group-distance-list report [ distancexy (mean [xcor] of living-agents with [ group.identity = [group.identity] of myself ]) (mean [ycor] of living-agents with [ group.identity = [group.identity] of myself ]) ] of living-agents end
to-report groups-distance-to-centroid-minimum report ifelse-value ( length group-distance-list < 1 ) [ "NA" ] [ min group-distance-list ] end
to-report groups-distance-to-centroid-maximum report ifelse-value ( length group-distance-list < 1 ) [ "NA" ] [ max group-distance-list ] end 
to-report groups-distance-to-centroid-mean report ifelse-value ( length group-distance-list < 1 ) [ "NA" ] [ mean group-distance-list ] end
to-report groups-distance-to-centroid-median report ifelse-value ( length group-distance-list < 1 ) [ "NA" ] [ median group-distance-list ] end
to-report groups-distance-to-centroid-variance report ifelse-value ( length group-distance-list < 2 ) [ "NA" ] [ variance group-distance-list ] end
  
to-report adult-group-sizes report filter [ j -> j > 1 ] map [ i -> count living-agents with [ group.identity = i and life.history = "adult" ]] remove-duplicates [group.identity] of living-agents end
to-report adult-group-size-minimum report ifelse-value ( length adult-group-sizes < 1 ) [ "NA" ] [ min adult-group-sizes ] end
to-report adult-group-size-maximum report ifelse-value ( length adult-group-sizes < 1 ) [ "NA" ] [ max adult-group-sizes ]  end
to-report adult-group-size-mean report ifelse-value ( length adult-group-sizes < 1 ) [ "NA" ] [ mean adult-group-sizes ]  end
to-report adult-group-size-median report ifelse-value ( length adult-group-sizes < 1 ) [ "NA" ] [ median adult-group-sizes ] end
to-report adult-group-size-variance report ifelse-value ( length adult-group-sizes < 2 ) [ "NA" ] [ variance adult-group-sizes ]  end
  
to-report adult-males-who-disperse-count report count decayed-agents with [ biological.sex = "male" and life.history = "adult" and length group.transfers.history > 0 and death.group.identity != natal.group.identity ] end
to-report adult-males-who-not-disperse-count report count decayed-agents with [ biological.sex = "male" and life.history = "adult" ] -  adult-males-who-disperse-count end
to-report adult-males-percent-disperse report ( adult-males-who-disperse-count / ( adult-males-who-disperse-count + adult-males-who-not-disperse-count + 0.0000000001 ) ) end
to-report adult-females-who-disperse-count report count decayed-agents with [ biological.sex = "female" and life.history = "adult" and length group.transfers.history > 0 and death.group.identity != natal.group.identity ] end
to-report adult-females-who-not-disperse-count report count decayed-agents with [ biological.sex = "female" and life.history = "adult" ] - adult-females-who-disperse-count end
to-report adult-females-percent-disperse report ( adult-females-who-disperse-count / ( adult-females-who-disperse-count + adult-females-who-not-disperse-count + 0.0000000001 ) ) end
  
to-report adult-males-multiple-mates-count report count decayed-agents with [ biological.sex = "male" and life.history = "adult" and length remove-duplicates copulations.history > 1 ] end
to-report adult-males-single-mate-count report count decayed-agents with [ biological.sex = "male" and life.history = "adult" and length remove-duplicates copulations.history = 1 ] end
to-report adult-males-no-mates-count report count decayed-agents with [ biological.sex = "male" and life.history = "adult" and length remove-duplicates copulations.history = 0 ] end
to-report adult-males-percent-multiple-mates report ( adult-males-multiple-mates-count / ( adult-males-multiple-mates-count + adult-males-single-mate-count + adult-males-no-mates-count + 0.0000000001 ) ) end
to-report adult-females-multiple-mates-count report count decayed-agents with [ biological.sex = "female" and life.history = "adult" and length remove-duplicates copulations.history > 1 ] end
to-report adult-females-single-mate-count report count decayed-agents with [ biological.sex = "female" and life.history = "adult" and length remove-duplicates copulations.history = 1 ] end
to-report adult-females-no-mates-count report count decayed-agents with [ biological.sex = "female" and life.history = "adult" and length remove-duplicates copulations.history = 0 ] end
to-report adult-females-percent-multiple-mates report ( adult-females-multiple-mates-count / ( adult-females-multiple-mates-count + adult-females-single-mate-count + adult-females-no-mates-count + 0.0000000001 ) ) end

; emergent plant properties
to-report plant-abundance-maximum report ifelse-value ( length plant-abundance-record > 0 ) [ max plant-abundance-record ] [ "NA" ] end
to-report plant-abundance-minimum report ifelse-value ( length plant-abundance-record > 0 ) [ min plant-abundance-record ] [ "NA" ] end
to-report plant-abundance-mean report ifelse-value ( length plant-abundance-record > 0 ) [ mean plant-abundance-record ] [ "NA" ] end
to-report plant-abundance-variance report ifelse-value ( length plant-abundance-record > 1 ) [ variance plant-abundance-record ] [ "NA" ] end
to-report plant-patchiness-maximum report ifelse-value ( length plant-patchiness-record > 0 ) [  max plant-patchiness-record ] [ "NA" ] end
to-report plant-patchiness-minimum report ifelse-value ( length plant-patchiness-record > 0 ) [ min plant-patchiness-record ] [ "NA" ] end 
to-report plant-patchiness-mean report ifelse-value ( length plant-patchiness-record > 0 ) [ mean plant-patchiness-record ] [ "NA" ] end
to-report plant-patchiness-variance report ifelse-value ( length plant-patchiness-record > 1 ) [ variance plant-patchiness-record ] [ "NA" ] end
  
  ; population level
to-report total-simulated-individuals report ifelse-value ( any? decayed-agents ) [ count decayed-agents ] [ "NA" ] end  
to-report total-simulated-males report ifelse-value ( any? decayed-agents ) [ count decayed-agents with [ biological.sex = "male" ] ] [ "NA" ] end 
to-report total-simulated-females report ifelse-value ( any? decayed-agents ) [ count decayed-agents with [ biological.sex = "female" ] ] [ "NA" ] end 
to-report total-simulated-adults report ifelse-value ( any? decayed-agents ) [ count decayed-agents with [ life.history = "adult" ] ] [ "NA" ] end 
to-report population-size-maximum report ifelse-value ( length population-size-record < 1 ) [ "NA" ] [ max population-size-record ] end
to-report population-size-minimum report ifelse-value ( length population-size-record < 1 ) [ "NA" ] [ min population-size-record ] end
to-report population-size-mean report ifelse-value ( length population-size-record < 1 ) [ "NA" ] [ mean population-size-record ] end
to-report population-size-variance report ifelse-value ( length population-size-record < 2 ) [ "NA" ] [ variance population-size-record ] end 
  
  ; life history
to-report gestation-length-list report [ ticks.at.birth - ticks.at.conception ] of decayed-agents with [ ticks.at.birth != 0 and ticks.at.conception != 0 ] end
to-report gestation-length-maximum report ifelse-value ( length gestation-length-list < 1 ) [ "NA" ] [ max gestation-length-list ] end
to-report gestation-length-minimum report ifelse-value ( length gestation-length-list < 1 ) [ "NA" ] [ min gestation-length-list ]  end
to-report gestation-length-mean report ifelse-value ( length gestation-length-list < 1 ) [ "NA" ] [ mean gestation-length-list ] end
to-report gestation-length-variance report ifelse-value ( length gestation-length-list < 2 ) [ "NA" ] [ variance gestation-length-list ] end
  
to-report lactation-length-list report [ ticks.at.weaning - ticks.at.birth ] of decayed-agents with [ ticks.at.weaning != 0 and ticks.at.birth != 0 ] end
to-report lactation-length-maximum report ifelse-value ( length lactation-length-list < 1 ) [ "NA" ] [ max lactation-length-list ] end
to-report lactation-length-minimum report ifelse-value ( length lactation-length-list < 1 ) [ "NA" ] [ min lactation-length-list ] end
to-report lactation-length-mean report ifelse-value ( length lactation-length-list < 1 ) [ "NA" ] [ mean lactation-length-list ] end
to-report lactation-length-variance report ifelse-value ( length lactation-length-list < 2 ) [ "NA" ] [ variance lactation-length-list ] end
  
to-report juvenile-length-list report [ ticks.at.sexual.maturity - ticks.at.weaning ] of decayed-agents with [ ticks.at.sexual.maturity != 0 and ticks.at.weaning != 0 ] end
to-report juvenile-length-maximum report ifelse-value ( length juvenile-length-list < 1 ) [ "NA" ] [ max juvenile-length-list ] end
to-report juvenile-length-minimum report ifelse-value ( length juvenile-length-list < 1 ) [ "NA" ] [ min juvenile-length-list ] end
to-report juvenile-length-mean report ifelse-value ( length juvenile-length-list < 1 ) [ "NA" ] [ mean juvenile-length-list ] end
to-report juvenile-length-variance report ifelse-value ( length juvenile-length-list < 2 ) [ "NA" ] [ variance juvenile-length-list ] end 
  
to-report male-age-at-first-reproduction-list report [ ticks.at.sexual.maturity - ticks.at.conception ] of decayed-agents with [ biological.sex = "male" and ticks.at.sexual.maturity != 0 and ticks.at.conception != 0 ] end
to-report male-age-at-first-reproduction-maximum report ifelse-value ( length male-age-at-first-reproduction-list < 1 ) [ "NA" ] [ max male-age-at-first-reproduction-list ] end
to-report male-age-at-first-reproduction-minimum report ifelse-value ( length male-age-at-first-reproduction-list < 1 ) [ "NA" ] [ min male-age-at-first-reproduction-list ] end
to-report male-age-at-first-reproduction-mean report ifelse-value ( length male-age-at-first-reproduction-list < 1 ) [ "NA" ] [ mean male-age-at-first-reproduction-list ] end 
to-report male-age-at-first-reproduction-variance report ifelse-value ( length male-age-at-first-reproduction-list < 2 ) [ "NA" ] [ variance male-age-at-first-reproduction-list ] end 
  
to-report female-age-at-first-reproduction-list report [ ticks.at.sexual.maturity - ticks.at.conception ] of decayed-agents with [ biological.sex = "female" and ticks.at.sexual.maturity != 0 and ticks.at.conception != 0 ] end
to-report female-age-at-first-reproduction-maximum report ifelse-value ( length female-age-at-first-reproduction-list < 1 ) [ "NA" ] [ max female-age-at-first-reproduction-list ] end
to-report female-age-at-first-reproduction-minimum report ifelse-value ( length female-age-at-first-reproduction-list < 1 ) [ "NA" ] [ min female-age-at-first-reproduction-list ] end
to-report female-age-at-first-reproduction-mean report ifelse-value ( length female-age-at-first-reproduction-list < 1 ) [ "NA" ] [ mean female-age-at-first-reproduction-list ] end 
to-report female-age-at-first-reproduction-variance report ifelse-value ( length female-age-at-first-reproduction-list < 2 ) [ "NA" ] [ variance female-age-at-first-reproduction-list ] end
  
to-report male-adult-longevity-list report [ ticks.at.death - ticks.at.conception ] of decayed-agents with [ biological.sex = "male" and ticks.at.death != 0 and ticks.at.conception != 0 ] end
to-report male-adult-longevity-maximum report ifelse-value ( length male-adult-longevity-list < 1 ) [ "NA" ] [ max male-adult-longevity-list ] end 
to-report male-adult-longevity-minimum report ifelse-value ( length male-adult-longevity-list < 1 ) [ "NA" ] [ min male-adult-longevity-list ] end 
to-report male-adult-longevity-mean report ifelse-value ( length male-adult-longevity-list < 1 ) [ "NA" ] [ mean male-adult-longevity-list ] end 
to-report male-adult-longevity-variance report ifelse-value ( length male-adult-longevity-list < 2 ) [ "NA" ] [ variance male-adult-longevity-list ] end
  
to-report female-adult-longevity-list report [ ticks.at.death - ticks.at.conception ] of decayed-agents with [ biological.sex = "female" and ticks.at.death != 0 and ticks.at.conception != 0 ] end
to-report female-adult-longevity-maximum report ifelse-value ( length female-adult-longevity-list < 1 ) [ "NA" ] [ max female-adult-longevity-list ] end 
to-report female-adult-longevity-minimum report ifelse-value ( length female-adult-longevity-list < 1 ) [ "NA" ] [ min female-adult-longevity-list ] end 
to-report female-adult-longevity-mean report ifelse-value ( length female-adult-longevity-list < 1 ) [ "NA" ] [ mean female-adult-longevity-list ] end 
to-report female-adult-longevity-variance report ifelse-value ( length female-adult-longevity-list < 2 ) [ "NA" ] [ variance female-adult-longevity-list ] end 
  
  ; adult attributes
to-report male-adult-hidden-chance-list report [ adult.hidden.chance ] of decayed-agents with [ biological.sex = "male" and adult.hidden.chance != 0 ] end
to-report male-adult-hidden-chance-maximum report ifelse-value ( length male-adult-hidden-chance-list < 1 ) [ "NA" ] [ max male-adult-hidden-chance-list ] end
to-report male-adult-hidden-chance-minimum report ifelse-value ( length male-adult-hidden-chance-list < 1 ) [ "NA" ] [ min male-adult-hidden-chance-list ] end
to-report male-adult-hidden-chance-mean report ifelse-value ( length male-adult-hidden-chance-list < 1 ) [ "NA" ] [ mean male-adult-hidden-chance-list ] end
to-report male-adult-hidden-chance-variance report ifelse-value ( length male-adult-hidden-chance-list < 2 ) [ "NA" ] [ variance male-adult-hidden-chance-list ] end
  
to-report female-adult-hidden-chance-list report [ adult.hidden.chance ] of decayed-agents with [ biological.sex = "female" and adult.hidden.chance != 0 ] end
to-report female-adult-hidden-chance-maximum report ifelse-value ( length female-adult-hidden-chance-list < 1 ) [ "NA" ] [ max female-adult-hidden-chance-list ] end
to-report female-adult-hidden-chance-minimum report ifelse-value ( length female-adult-hidden-chance-list < 1 ) [ "NA" ] [ min female-adult-hidden-chance-list ] end
to-report female-adult-hidden-chance-mean report ifelse-value ( length female-adult-hidden-chance-list < 1 ) [ "NA" ] [ mean female-adult-hidden-chance-list ] end
to-report female-adult-hidden-chance-variance report ifelse-value ( length female-adult-hidden-chance-list < 2 ) [ "NA" ] [ variance female-adult-hidden-chance-list ] end
  
to-report male-adult-survival-chance-list report [ adult.survival.chance ] of decayed-agents with [ biological.sex = "male" and adult.survival.chance != 0 ] end
to-report male-adult-survival-chance-maximum report ifelse-value ( length male-adult-survival-chance-list < 1 ) [ "NA" ] [ max male-adult-survival-chance-list ] end
to-report male-adult-survival-chance-minimum report ifelse-value ( length male-adult-survival-chance-list < 1 ) [ "NA" ] [ min male-adult-survival-chance-list ] end
to-report male-adult-survival-chance-mean report ifelse-value ( length male-adult-survival-chance-list < 1 ) [ "NA" ] [ mean male-adult-survival-chance-list ] end
to-report male-adult-survival-chance-variance report ifelse-value ( length male-adult-survival-chance-list < 2 ) [ "NA" ] [ variance male-adult-survival-chance-list ] end
  
to-report female-adult-survival-chance-list report [ adult.survival.chance ] of decayed-agents with [ biological.sex = "female" and adult.survival.chance != 0 ] end
to-report female-adult-survival-chance-maximum report ifelse-value ( length female-adult-survival-chance-list < 1 ) [ "NA" ] [ max female-adult-survival-chance-list ] end
to-report female-adult-survival-chance-minimum report ifelse-value ( length female-adult-survival-chance-list < 1 ) [ "NA" ] [ min female-adult-survival-chance-list ] end
to-report female-adult-survival-chance-mean report ifelse-value ( length female-adult-survival-chance-list < 1 ) [ "NA" ] [ mean female-adult-survival-chance-list ] end
to-report female-adult-survival-chance-variance report ifelse-value ( length female-adult-survival-chance-list < 2 ) [ "NA" ] [ variance female-adult-survival-chance-list ] end
  
to-report male-adult-body-size-list report [ adult.body.size ] of decayed-agents with [ biological.sex = "male" and adult.body.size != 0 ] end
to-report male-adult-body-size-maximum report ifelse-value ( length male-adult-body-size-list < 1 ) [ "NA" ] [ max male-adult-body-size-list ] end
to-report male-adult-body-size-minimum report ifelse-value ( length male-adult-body-size-list < 1 ) [ "NA" ] [ min male-adult-body-size-list ] end
to-report male-adult-body-size-mean report ifelse-value ( length male-adult-body-size-list < 1 ) [ "NA" ] [ mean male-adult-body-size-list ] end
to-report male-adult-body-size-variance report ifelse-value ( length male-adult-body-size-list < 2 ) [ "NA" ] [ variance male-adult-body-size-list ] end
  
to-report female-adult-body-size-list report [ adult.body.size ] of decayed-agents with [ biological.sex = "female" and adult.body.size != 0 ] end
to-report female-adult-body-size-maximum report ifelse-value ( length female-adult-body-size-list < 1 ) [ "NA" ] [ max female-adult-body-size-list ] end
to-report female-adult-body-size-minimum report ifelse-value ( length female-adult-body-size-list < 1 ) [ "NA" ] [ min female-adult-body-size-list ] end
to-report female-adult-body-size-mean report ifelse-value ( length female-adult-body-size-list < 1 ) [ "NA" ] [ mean female-adult-body-size-list ] end
to-report female-adult-body-size-variance report ifelse-value ( length female-adult-body-size-list < 2 ) [ "NA" ] [ variance female-adult-body-size-list ] end
  
to-report male-adult-body-shade-list report [ adult.body.shade ] of decayed-agents with [ biological.sex = "male" and adult.body.shade != 0 ] end
to-report male-adult-body-shade-maximum report ifelse-value ( length male-adult-body-shade-list < 1 ) [ "NA" ] [ max male-adult-body-shade-list ] end
to-report male-adult-body-shade-minimum report ifelse-value ( length male-adult-body-shade-list < 1 ) [ "NA" ] [ min male-adult-body-shade-list ] end
to-report male-adult-body-shade-mean report ifelse-value ( length male-adult-body-shade-list < 1 ) [ "NA" ] [ mean male-adult-body-shade-list ] end
to-report male-adult-body-shade-variance report ifelse-value ( length male-adult-body-shade-list < 2 ) [ "NA" ] [ variance male-adult-body-shade-list ] end
  
to-report female-adult-body-shade-list report [ adult.body.shade ] of decayed-agents with [ biological.sex = "female" and adult.body.shade != 0 ] end
to-report female-adult-body-shade-maximum report ifelse-value ( length female-adult-body-shade-list < 1 ) [ "NA" ] [ max female-adult-body-shade-list ] end
to-report female-adult-body-shade-minimum report ifelse-value ( length female-adult-body-shade-list < 1 ) [ "NA" ] [ min female-adult-body-shade-list ] end
to-report female-adult-body-shade-mean report ifelse-value ( length female-adult-body-shade-list < 1 ) [ "NA" ] [ mean female-adult-body-shade-list ] end
to-report female-adult-body-shade-variance report ifelse-value ( length female-adult-body-shade-list < 2 ) [ "NA" ] [ variance female-adult-body-shade-list ] end
  
to-report male-adult-energy-supply-list report [ adult.energy.supply ] of decayed-agents with [ biological.sex = "male" and adult.energy.supply != 0 ] end
to-report male-adult-energy-supply-maximum report ifelse-value ( length male-adult-energy-supply-list < 1 ) [ "NA" ] [ max male-adult-energy-supply-list ] end
to-report male-adult-energy-supply-minimum report ifelse-value ( length male-adult-energy-supply-list < 1 ) [ "NA" ] [ min male-adult-energy-supply-list ] end
to-report male-adult-energy-supply-mean report ifelse-value ( length male-adult-energy-supply-list < 1 ) [ "NA" ] [ mean male-adult-energy-supply-list ] end
to-report male-adult-energy-supply-variance report ifelse-value ( length male-adult-energy-supply-list < 2 ) [ "NA" ] [ variance male-adult-energy-supply-list ] end
  
to-report female-adult-energy-supply-list report [ adult.energy.supply ] of decayed-agents with [ biological.sex = "female" and adult.energy.supply != 0 ] end
to-report female-adult-energy-supply-maximum report ifelse-value ( length female-adult-energy-supply-list < 1 ) [ "NA" ] [ max female-adult-energy-supply-list ] end
to-report female-adult-energy-supply-minimum report ifelse-value ( length female-adult-energy-supply-list < 1 ) [ "NA" ] [ min female-adult-energy-supply-list ] end
to-report female-adult-energy-supply-mean report ifelse-value ( length female-adult-energy-supply-list < 1 ) [ "NA" ] [ mean female-adult-energy-supply-list ] end
to-report female-adult-energy-supply-variance report ifelse-value ( length female-adult-energy-supply-list < 2 ) [ "NA" ] [ variance female-adult-energy-supply-list ] end
  
to-report male-adult-bite-capacity-list report [ adult.bite.capacity ] of decayed-agents with [ biological.sex = "male" and adult.bite.capacity != 0 ] end
to-report male-adult-bite-capacity-maximum report ifelse-value ( length male-adult-bite-capacity-list < 1 ) [ "NA" ] [ max male-adult-bite-capacity-list ] end
to-report male-adult-bite-capacity-minimum report ifelse-value ( length male-adult-bite-capacity-list < 1 ) [ "NA" ] [ min male-adult-bite-capacity-list ] end
to-report male-adult-bite-capacity-mean report ifelse-value ( length male-adult-bite-capacity-list < 1 ) [ "NA" ] [ mean male-adult-bite-capacity-list ] end
to-report male-adult-bite-capacity-variance report ifelse-value ( length male-adult-bite-capacity-list < 2 ) [ "NA" ] [ variance male-adult-bite-capacity-list ] end
  
to-report female-adult-bite-capacity-list report [ adult.bite.capacity ] of decayed-agents with [ biological.sex = "female" and adult.bite.capacity != 0 ] end
to-report female-adult-bite-capacity-maximum report ifelse-value ( length female-adult-bite-capacity-list < 1 ) [ "NA" ] [ max female-adult-bite-capacity-list ] end
to-report female-adult-bite-capacity-minimum report ifelse-value ( length female-adult-bite-capacity-list < 1 ) [ "NA" ] [ min female-adult-bite-capacity-list ] end
to-report female-adult-bite-capacity-mean report ifelse-value ( length female-adult-bite-capacity-list < 1 ) [ "NA" ] [ mean female-adult-bite-capacity-list ] end
to-report female-adult-bite-capacity-variance report ifelse-value ( length female-adult-bite-capacity-list < 2 ) [ "NA" ] [ variance female-adult-bite-capacity-list ] end
  
to-report male-adult-mutation-chance-list report [ adult.mutation.chance ] of decayed-agents with [ biological.sex = "male" and adult.mutation.chance != 0 ] end
to-report male-adult-mutation-chance-maximum report ifelse-value ( length male-adult-mutation-chance-list < 1 ) [ "NA" ] [ max male-adult-mutation-chance-list ] end
to-report male-adult-mutation-chance-minimum report ifelse-value ( length male-adult-mutation-chance-list < 1 ) [ "NA" ] [ min male-adult-mutation-chance-list ] end
to-report male-adult-mutation-chance-mean report ifelse-value ( length male-adult-mutation-chance-list < 1 ) [ "NA" ] [ mean male-adult-mutation-chance-list ] end
to-report male-adult-mutation-chance-variance report ifelse-value ( length male-adult-mutation-chance-list < 2 ) [ "NA" ] [ variance male-adult-mutation-chance-list ] end
  
to-report female-adult-mutation-chance-list report [ adult.mutation.chance ] of decayed-agents with [ biological.sex = "female" and adult.mutation.chance != 0 ] end
to-report female-adult-mutation-chance-maximum report ifelse-value ( length female-adult-mutation-chance-list < 1 ) [ "NA" ] [ max female-adult-mutation-chance-list ] end
to-report female-adult-mutation-chance-minimum report ifelse-value ( length female-adult-mutation-chance-list < 1 ) [ "NA" ] [ min female-adult-mutation-chance-list ] end
to-report female-adult-mutation-chance-mean report ifelse-value ( length female-adult-mutation-chance-list < 1 ) [ "NA" ] [ mean female-adult-mutation-chance-list ] end
to-report female-adult-mutation-chance-variance report ifelse-value ( length female-adult-mutation-chance-list < 2 ) [ "NA" ] [ variance female-adult-mutation-chance-list ] end
  
to-report male-adult-sex-ratio-list report [ adult.sex.ratio ] of decayed-agents with [ biological.sex = "male" and adult.sex.ratio != 0 ] end
to-report male-adult-sex-ratio-maximum report ifelse-value ( length male-adult-sex-ratio-list < 1 ) [ "NA" ] [ max male-adult-sex-ratio-list ] end
to-report male-adult-sex-ratio-minimum report ifelse-value ( length male-adult-sex-ratio-list < 1 ) [ "NA" ] [ min male-adult-sex-ratio-list ] end
to-report male-adult-sex-ratio-mean report ifelse-value ( length male-adult-sex-ratio-list < 1 ) [ "NA" ] [ mean male-adult-sex-ratio-list ] end
to-report male-adult-sex-ratio-variance report ifelse-value ( length male-adult-sex-ratio-list < 2 ) [ "NA" ] [ variance male-adult-sex-ratio-list ] end
  
to-report female-adult-sex-ratio-list report [ adult.sex.ratio ] of decayed-agents with [ biological.sex = "female" and adult.sex.ratio != 0 ] end
to-report female-adult-sex-ratio-maximum report ifelse-value ( length female-adult-sex-ratio-list < 1 ) [ "NA" ] [ max female-adult-sex-ratio-list ] end
to-report female-adult-sex-ratio-minimum report ifelse-value ( length female-adult-sex-ratio-list < 1 ) [ "NA" ] [ min female-adult-sex-ratio-list ] end
to-report female-adult-sex-ratio-mean report ifelse-value ( length female-adult-sex-ratio-list < 1 ) [ "NA" ] [ mean female-adult-sex-ratio-list ] end
to-report female-adult-sex-ratio-variance report ifelse-value ( length female-adult-sex-ratio-list < 2 ) [ "NA" ] [ variance female-adult-sex-ratio-list ] end
  
to-report male-adult-litter-size-list report [ adult.litter.size ] of decayed-agents with [ biological.sex = "male" and adult.litter.size != 0 ] end
to-report male-adult-litter-size-maximum report ifelse-value ( length male-adult-litter-size-list < 1 ) [ "NA" ] [ max male-adult-litter-size-list ] end
to-report male-adult-litter-size-minimum report ifelse-value ( length male-adult-litter-size-list < 1 ) [ "NA" ] [ min male-adult-litter-size-list ] end
to-report male-adult-litter-size-mean report ifelse-value ( length male-adult-litter-size-list < 1 ) [ "NA" ] [ mean male-adult-litter-size-list ] end
to-report male-adult-litter-size-variance report ifelse-value ( length male-adult-litter-size-list < 2 ) [ "NA" ] [ variance male-adult-litter-size-list ] end
  
to-report female-adult-litter-size-list report [ adult.litter.size ] of decayed-agents with [ biological.sex = "female" and adult.litter.size != 0 ] end
to-report female-adult-litter-size-maximum report ifelse-value ( length female-adult-litter-size-list < 1 ) [ "NA" ] [ max female-adult-litter-size-list ] end
to-report female-adult-litter-size-minimum report ifelse-value ( length female-adult-litter-size-list < 1 ) [ "NA" ] [ min female-adult-litter-size-list ] end
to-report female-adult-litter-size-mean report ifelse-value ( length female-adult-litter-size-list < 1 ) [ "NA" ] [ mean female-adult-litter-size-list ] end
to-report female-adult-litter-size-variance report ifelse-value ( length female-adult-litter-size-list < 2 ) [ "NA" ] [ variance female-adult-litter-size-list ] end
  
to-report male-adult-conception-chance-list report [ adult.conception.chance ] of decayed-agents with [ biological.sex = "male" and adult.conception.chance != 0 ] end
to-report male-adult-conception-chance-maximum report ifelse-value ( length male-adult-conception-chance-list < 1 ) [ "NA" ] [ max male-adult-conception-chance-list ] end
to-report male-adult-conception-chance-minimum report ifelse-value ( length male-adult-conception-chance-list < 1 ) [ "NA" ] [ min male-adult-conception-chance-list ] end
to-report male-adult-conception-chance-mean report ifelse-value ( length male-adult-conception-chance-list < 1 ) [ "NA" ] [ mean male-adult-conception-chance-list ] end
to-report male-adult-conception-chance-variance report ifelse-value ( length male-adult-conception-chance-list < 2 ) [ "NA" ] [ variance male-adult-conception-chance-list ] end
  
to-report female-adult-conception-chance-list report [ adult.conception.chance ] of decayed-agents with [ biological.sex = "female" and adult.conception.chance != 0 ] end
to-report female-adult-conception-chance-maximum report ifelse-value ( length female-adult-conception-chance-list < 1 ) [ "NA" ] [ max female-adult-conception-chance-list ] end
to-report female-adult-conception-chance-minimum report ifelse-value ( length female-adult-conception-chance-list < 1 ) [ "NA" ] [ min female-adult-conception-chance-list ] end
to-report female-adult-conception-chance-mean report ifelse-value ( length female-adult-conception-chance-list < 1 ) [ "NA" ] [ mean female-adult-conception-chance-list ]  end
to-report female-adult-conception-chance-variance report ifelse-value ( length female-adult-conception-chance-list < 2 ) [ "NA" ] [ variance female-adult-conception-chance-list ]  end
  
to-report male-adult-visual-angle-list report [ adult.visual.angle ] of decayed-agents with [ biological.sex = "male" and adult.visual.angle != 0 ] end
to-report male-adult-visual-angle-maximum report ifelse-value ( length male-adult-visual-angle-list < 1 ) [ "NA" ] [ max male-adult-visual-angle-list ] end
to-report male-adult-visual-angle-minimum report ifelse-value ( length male-adult-visual-angle-list < 1 ) [ "NA" ] [ min male-adult-visual-angle-list ] end
to-report male-adult-visual-angle-mean report ifelse-value ( length male-adult-visual-angle-list < 1 ) [ "NA" ] [ mean male-adult-visual-angle-list ] end
to-report male-adult-visual-angle-variance report ifelse-value ( length male-adult-visual-angle-list < 2 ) [ "NA" ] [ variance male-adult-visual-angle-list ] end
  
to-report female-adult-visual-angle-list report [ adult.visual.angle ] of decayed-agents with [ biological.sex = "female" and adult.visual.angle != 0 ] end
to-report female-adult-visual-angle-maximum report ifelse-value ( length female-adult-visual-angle-list < 1 ) [ "NA" ] [ max female-adult-visual-angle-list ] end
to-report female-adult-visual-angle-minimum report ifelse-value ( length female-adult-visual-angle-list < 1 ) [ "NA" ] [ min female-adult-visual-angle-list ] end
to-report female-adult-visual-angle-mean report ifelse-value ( length female-adult-visual-angle-list < 1 ) [ "NA" ] [ mean female-adult-visual-angle-list ]  end
to-report female-adult-visual-angle-variance report ifelse-value ( length female-adult-visual-angle-list < 2 ) [ "NA" ] [ variance female-adult-visual-angle-list ]  end
  
to-report male-adult-visual-range-list report [ adult.visual.range ] of decayed-agents with [ biological.sex = "male" and adult.visual.range != 0 ] end
to-report male-adult-visual-range-maximum report ifelse-value ( length male-adult-visual-range-list < 1 ) [ "NA" ] [ max male-adult-visual-range-list ] end
to-report male-adult-visual-range-minimum report ifelse-value ( length male-adult-visual-range-list < 1 ) [ "NA" ] [ min male-adult-visual-range-list ] end
to-report male-adult-visual-range-mean report ifelse-value ( length male-adult-visual-range-list < 1 ) [ "NA" ] [ mean male-adult-visual-range-list ] end
to-report male-adult-visual-range-variance report ifelse-value ( length male-adult-visual-range-list < 2 ) [ "NA" ] [ variance male-adult-visual-range-list ] end
  
to-report female-adult-visual-range-list report [ adult.visual.range ] of decayed-agents with [ biological.sex = "female" and adult.visual.range != 0 ] end
to-report female-adult-visual-range-maximum report ifelse-value ( length female-adult-visual-range-list < 1 ) [ "NA" ] [ max female-adult-visual-range-list ] end
to-report female-adult-visual-range-minimum report ifelse-value ( length female-adult-visual-range-list < 1 ) [ "NA" ] [ min female-adult-visual-range-list ] end
to-report female-adult-visual-range-mean report ifelse-value ( length female-adult-visual-range-list < 1 ) [ "NA" ] [ mean female-adult-visual-range-list ] end
to-report female-adult-visual-range-variance report ifelse-value ( length female-adult-visual-range-list < 2 ) [ "NA" ] [ variance female-adult-visual-range-list ] end
  
to-report male-adult-day-perception-list report [ adult.day.perception ] of decayed-agents with [ biological.sex = "male" and adult.day.perception != 0 ] end
to-report male-adult-day-perception-maximum report ifelse-value ( length male-adult-day-perception-list < 1 ) [ "NA" ] [ max male-adult-day-perception-list ] end
to-report male-adult-day-perception-minimum report ifelse-value ( length male-adult-day-perception-list < 1 ) [ "NA" ] [ min male-adult-day-perception-list ] end
to-report male-adult-day-perception-mean report ifelse-value ( length male-adult-day-perception-list < 1 ) [ "NA" ] [ mean male-adult-day-perception-list ] end
to-report male-adult-day-perception-variance report ifelse-value ( length male-adult-day-perception-list < 2 ) [ "NA" ] [ variance male-adult-day-perception-list ] end
  
to-report female-adult-day-perception-list report [ adult.day.perception ] of decayed-agents with [ biological.sex = "female" and adult.day.perception != 0 ] end
to-report female-adult-day-perception-maximum report ifelse-value ( length female-adult-day-perception-list < 1 ) [ "NA" ] [ max female-adult-day-perception-list ] end
to-report female-adult-day-perception-minimum report ifelse-value ( length female-adult-day-perception-list < 1 ) [ "NA" ] [ min female-adult-day-perception-list ] end
to-report female-adult-day-perception-mean report ifelse-value ( length female-adult-day-perception-list < 1 ) [ "NA" ] [ mean female-adult-day-perception-list ] end
to-report female-adult-day-perception-variance report ifelse-value ( length female-adult-day-perception-list < 2 ) [ "NA" ] [ variance female-adult-day-perception-list ] end
  
to-report male-adult-night-perception-list report [ adult.night.perception ] of decayed-agents with [ biological.sex = "male" and adult.night.perception != 0 ] end
to-report male-adult-night-perception-maximum report ifelse-value ( length male-adult-night-perception-list < 1 ) [ "NA" ] [ max male-adult-night-perception-list ] end
to-report male-adult-night-perception-minimum report ifelse-value ( length male-adult-night-perception-list < 1 ) [ "NA" ] [ min male-adult-night-perception-list ] end
to-report male-adult-night-perception-mean report ifelse-value ( length male-adult-night-perception-list < 1 ) [ "NA" ] [ mean male-adult-night-perception-list ] end
to-report male-adult-night-perception-variance report ifelse-value ( length male-adult-night-perception-list < 2 ) [ "NA" ] [ variance male-adult-night-perception-list ] end
  
to-report female-adult-night-perception-list report [ adult.night.perception ] of decayed-agents with [ biological.sex = "female" and adult.night.perception != 0 ] end
to-report female-adult-night-perception-maximum report ifelse-value ( length female-adult-night-perception-list < 1 ) [ "NA" ] [ max female-adult-night-perception-list ] end
to-report female-adult-night-perception-minimum report ifelse-value ( length female-adult-night-perception-list < 1 ) [ "NA" ] [ min female-adult-night-perception-list ] end
to-report female-adult-night-perception-mean report ifelse-value ( length female-adult-night-perception-list < 1 ) [ "NA" ] [ mean female-adult-night-perception-list ] end
to-report female-adult-night-perception-variance report ifelse-value ( length female-adult-night-perception-list < 2 ) [ "NA" ] [ variance female-adult-night-perception-list ] end
  
  ; behavior history
to-report natal-group-size-list report [ natal.group.size ] of decayed-agents end
to-report natal-group-size-maximum report ifelse-value ( length natal-group-size-list < 1 ) [ "NA" ] [ max natal-group-size-list ]  end
to-report natal-group-size-minimum report ifelse-value ( length natal-group-size-list < 1 ) [ "NA" ] [ min natal-group-size-list ]  end
to-report natal-group-size-mean report ifelse-value ( length natal-group-size-list < 1 ) [ "NA" ] [ mean natal-group-size-list ]  end
to-report natal-group-size-variance report ifelse-value ( length natal-group-size-list < 2 ) [ "NA" ] [ variance natal-group-size-list ] end
  
to-report death-group-size-list report [ death.group.size ] of decayed-agents with [ death.group.size > 1 ] end
to-report death-group-size-maximum report ifelse-value ( length death-group-size-list < 1 ) [ "NA" ] [ max death-group-size-list ]  end
to-report death-group-size-minimum report ifelse-value ( length death-group-size-list < 1 ) [ "NA" ] [ min death-group-size-list ]  end
to-report death-group-size-mean report ifelse-value ( length death-group-size-list < 1 ) [ "NA" ] [ mean death-group-size-list ]  end
to-report death-group-size-variance report ifelse-value ( length death-group-size-list < 2 ) [ "NA" ] [ variance death-group-size-list ] end
  
to-report male-lifetime-distance-traveled-list report [ distance.traveled ] of decayed-agents with [ biological.sex = "male" and life.history = "adult" ] end
to-report male-lifetime-distance-traveled-maximum report ifelse-value ( length male-lifetime-distance-traveled-list < 1 ) [ "NA" ] [ max male-lifetime-distance-traveled-list ] end
to-report male-lifetime-distance-traveled-minimum report ifelse-value ( length male-lifetime-distance-traveled-list < 1 ) [ "NA" ] [ min male-lifetime-distance-traveled-list ] end
to-report male-lifetime-distance-traveled-mean report ifelse-value ( length male-lifetime-distance-traveled-list < 1 ) [ "NA" ] [ mean male-lifetime-distance-traveled-list ] end
to-report male-lifetime-distance-traveled-variance report ifelse-value ( length male-lifetime-distance-traveled-list < 2 ) [ "NA" ] [ variance male-lifetime-distance-traveled-list ] end
  
to-report female-lifetime-distance-traveled-list report [ distance.traveled ] of decayed-agents with [ biological.sex = "female" and life.history = "adult" ] end
to-report female-lifetime-distance-traveled-maximum report ifelse-value ( length female-lifetime-distance-traveled-list < 1 ) [ "NA" ] [ max female-lifetime-distance-traveled-list ] end
to-report female-lifetime-distance-traveled-minimum report ifelse-value ( length female-lifetime-distance-traveled-list < 1 ) [ "NA" ] [ min female-lifetime-distance-traveled-list ] end
to-report female-lifetime-distance-traveled-mean report ifelse-value ( length female-lifetime-distance-traveled-list < 1 ) [ "NA" ] [ mean female-lifetime-distance-traveled-list ] end
to-report female-lifetime-distance-traveled-variance report ifelse-value ( length female-lifetime-distance-traveled-list < 2 ) [ "NA" ] [ variance female-lifetime-distance-traveled-list ] end
  
to-report mother-initiated-birth-count report count decayed-agents with [ mother.initiated.birth ] end
to-report offspring-initiated-birth-count report count decayed-agents with [ not mother.initiated.birth ] end
to-report mother-initiated-birth-percent report mother-initiated-birth-count / ( mother-initiated-birth-count + offspring-initiated-birth-count + 0.0000000001 ) end
to-report mother-initiated-weaning-count report count decayed-agents with [ mother.initiated.weaning ] end
to-report offspring-initiated-weaning-count report count decayed-agents with [ not mother.initiated.weaning ] end
to-report mother-initiated-weaning-percent report mother-initiated-weaning-count / ( mother-initiated-weaning-count + offspring-initiated-weaning-count + 0.0000000001 ) end
  
to-report male-lifetime-foraging-gains-list report [ foraging.gains ] of decayed-agents with [ biological.sex = "male" and life.history = "adult" ] end
to-report male-lifetime-foraging-gains-maximum report ifelse-value ( length male-lifetime-foraging-gains-list < 1 ) [ "NA" ] [ max male-lifetime-foraging-gains-list ] end  
to-report male-lifetime-foraging-gains-minimum report ifelse-value ( length male-lifetime-foraging-gains-list < 1 ) [ "NA" ] [ min male-lifetime-foraging-gains-list ] end
to-report male-lifetime-foraging-gains-mean report ifelse-value ( length male-lifetime-foraging-gains-list < 1 ) [ "NA" ] [ mean male-lifetime-foraging-gains-list ] end
to-report male-lifetime-foraging-gains-variance report ifelse-value ( length male-lifetime-foraging-gains-list < 2 ) [ "NA" ] [ variance male-lifetime-foraging-gains-list ] end
to-report total-population-male-lifetime-foraging-gains report sum male-lifetime-foraging-gains-list end
    
to-report female-lifetime-foraging-gains-list report [ foraging.gains ] of decayed-agents with [ biological.sex = "female" and life.history = "adult" ] end
to-report female-lifetime-foraging-gains-maximum report ifelse-value ( length female-lifetime-foraging-gains-list < 1 ) [ "NA" ] [ max female-lifetime-foraging-gains-list ] end
to-report female-lifetime-foraging-gains-minimum report ifelse-value ( length female-lifetime-foraging-gains-list < 1 ) [ "NA" ] [ min female-lifetime-foraging-gains-list ] end
to-report female-lifetime-foraging-gains-mean report ifelse-value ( length female-lifetime-foraging-gains-list < 1 ) [ "NA" ] [ mean female-lifetime-foraging-gains-list ] end
to-report female-lifetime-foraging-gains-variance report ifelse-value ( length female-lifetime-foraging-gains-list < 2 ) [ "NA" ] [ variance female-lifetime-foraging-gains-list ] end
to-report total-population-female-lifetime-foraging-gains report sum female-lifetime-foraging-gains-list end
  
to-report male-lifetime-energy-gains-list report [ total.energy.gains ] of decayed-agents with [ biological.sex = "male" and life.history = "adult" ] end
to-report male-lifetime-energy-gains-maximum report ifelse-value ( length male-lifetime-energy-gains-list < 1 ) [ "NA" ] [ max male-lifetime-energy-gains-list ] end  
to-report male-lifetime-energy-gains-minimum report ifelse-value ( length male-lifetime-energy-gains-list < 1 ) [ "NA" ] [ min male-lifetime-energy-gains-list ] end
to-report male-lifetime-energy-gains-mean report ifelse-value ( length male-lifetime-energy-gains-list < 1 ) [ "NA" ] [ mean male-lifetime-energy-gains-list ] end
to-report male-lifetime-energy-gains-variance report ifelse-value ( length male-lifetime-energy-gains-list < 2 ) [ "NA" ] [ variance male-lifetime-energy-gains-list ] end
to-report total-population-male-lifetime-energy-gains report sum male-lifetime-energy-gains-list end
      
to-report female-lifetime-energy-gains-list report [ total.energy.gains ] of decayed-agents with [ biological.sex = "female" and life.history = "adult" ] end
to-report female-lifetime-energy-gains-maximum report ifelse-value ( length female-lifetime-energy-gains-list < 1 ) [ "NA" ] [ max female-lifetime-energy-gains-list ] end
to-report female-lifetime-energy-gains-minimum report ifelse-value ( length female-lifetime-energy-gains-list < 1 ) [ "NA" ] [ min female-lifetime-energy-gains-list ] end
to-report female-lifetime-energy-gains-mean report ifelse-value ( length female-lifetime-energy-gains-list < 1 ) [ "NA" ] [ mean female-lifetime-energy-gains-list ] end
to-report female-lifetime-energy-gains-variance report ifelse-value ( length female-lifetime-energy-gains-list < 2 ) [ "NA" ] [ variance female-lifetime-energy-gains-list ] end
to-report total-population-female-lifetime-energy-gains report sum female-lifetime-energy-gains-list end
      
to-report male-lifetime-energy-cost-list report [ total.energy.cost ] of decayed-agents with [ biological.sex = "male" and life.history = "adult" ] end
to-report male-lifetime-energy-cost-maximum report ifelse-value ( length male-lifetime-energy-cost-list < 1 ) [ "NA" ] [ max male-lifetime-energy-cost-list ] end  
to-report male-lifetime-energy-cost-minimum report ifelse-value ( length male-lifetime-energy-cost-list < 1 ) [ "NA" ] [ min male-lifetime-energy-cost-list ] end
to-report male-lifetime-energy-cost-mean report ifelse-value ( length male-lifetime-energy-cost-list < 1 ) [ "NA" ] [ mean male-lifetime-energy-cost-list ] end
to-report male-lifetime-energy-cost-variance report ifelse-value ( length male-lifetime-energy-cost-list < 2 ) [ "NA" ] [ variance male-lifetime-energy-cost-list ] end
to-report total-population-male-lifetime-energy-cost report sum male-lifetime-energy-cost-list end
      
to-report female-lifetime-energy-cost-list report [ total.energy.cost ] of decayed-agents with [ biological.sex = "female" and life.history = "adult" ] end
to-report female-lifetime-energy-cost-maximum report ifelse-value ( length female-lifetime-energy-cost-list < 1 ) [ "NA" ] [ max female-lifetime-energy-cost-list ] end
to-report female-lifetime-energy-cost-minimum report ifelse-value ( length female-lifetime-energy-cost-list < 1 ) [ "NA" ] [ min female-lifetime-energy-cost-list ] end
to-report female-lifetime-energy-cost-mean report ifelse-value ( length female-lifetime-energy-cost-list < 1 ) [ "NA" ] [ mean female-lifetime-energy-cost-list ] end
to-report female-lifetime-energy-cost-variance report ifelse-value ( length female-lifetime-energy-cost-list < 2 ) [ "NA" ] [ variance female-lifetime-energy-cost-list ] end
to-report total-population-female-lifetime-energy-cost report sum female-lifetime-energy-cost-list end
      
to-report male-lifetime-whole-related-help-cost-list report [ whole.related.help.cost ] of decayed-agents with [ biological.sex = "male" and life.history = "adult" ] end
to-report male-lifetime-whole-related-help-cost-maximum report ifelse-value ( length male-lifetime-whole-related-help-cost-list < 1 ) [ "NA" ] [ max male-lifetime-whole-related-help-cost-list ] end
to-report male-lifetime-whole-related-help-cost-minimum report ifelse-value ( length male-lifetime-whole-related-help-cost-list < 1 ) [ "NA" ] [ min male-lifetime-whole-related-help-cost-list ] end
to-report male-lifetime-whole-related-help-cost-mean report ifelse-value ( length male-lifetime-whole-related-help-cost-list < 1 ) [ "NA" ] [ mean male-lifetime-whole-related-help-cost-list ] end
to-report male-lifetime-whole-related-help-cost-variance report ifelse-value ( length male-lifetime-whole-related-help-cost-list < 2 ) [ "NA" ] [ variance male-lifetime-whole-related-help-cost-list ] end
to-report total-population-male-lifetime-whole-related-help-cost report sum male-lifetime-whole-related-help-cost-list end
  
to-report female-lifetime-whole-related-help-cost-list report [ whole.related.help.cost ] of decayed-agents with [ biological.sex = "female" and life.history = "adult" ] end
to-report female-lifetime-whole-related-help-cost-maximum report ifelse-value ( length female-lifetime-whole-related-help-cost-list < 1 ) [ "NA" ] [ max female-lifetime-whole-related-help-cost-list ] end
to-report female-lifetime-whole-related-help-cost-minimum report ifelse-value ( length female-lifetime-whole-related-help-cost-list < 1 ) [ "NA" ] [ min female-lifetime-whole-related-help-cost-list ] end
to-report female-lifetime-whole-related-help-cost-mean report ifelse-value ( length female-lifetime-whole-related-help-cost-list < 1 ) [ "NA" ] [ mean female-lifetime-whole-related-help-cost-list ] end
to-report female-lifetime-whole-related-help-cost-variance report ifelse-value ( length female-lifetime-whole-related-help-cost-list < 2 ) [ "NA" ] [ variance female-lifetime-whole-related-help-cost-list ] end
to-report total-population-female-lifetime-whole-related-help-cost report sum female-lifetime-whole-related-help-cost-list end
  
to-report male-lifetime-half-related-help-cost-list report [ half.related.help.cost ] of decayed-agents with [ biological.sex = "male" and life.history = "adult" ] end
to-report male-lifetime-half-related-help-cost-maximum report ifelse-value ( length male-lifetime-half-related-help-cost-list < 1 ) [ "NA" ] [ max male-lifetime-half-related-help-cost-list ] end
to-report male-lifetime-half-related-help-cost-minimum report ifelse-value ( length male-lifetime-half-related-help-cost-list < 1 ) [ "NA" ] [ min male-lifetime-half-related-help-cost-list ] end
to-report male-lifetime-half-related-help-cost-mean report ifelse-value ( length male-lifetime-half-related-help-cost-list < 1 ) [ "NA" ] [ mean male-lifetime-half-related-help-cost-list ] end
to-report male-lifetime-half-related-help-cost-variance report ifelse-value ( length male-lifetime-half-related-help-cost-list < 2 ) [ "NA" ] [ variance male-lifetime-half-related-help-cost-list ] end
to-report total-population-male-lifetime-half-related-help-cost report sum male-lifetime-half-related-help-cost-list end
  
to-report female-lifetime-half-related-help-cost-list report [ half.related.help.cost ] of decayed-agents with [ biological.sex = "female" and life.history = "adult" ] end
to-report female-lifetime-half-related-help-cost-maximum report ifelse-value ( length female-lifetime-half-related-help-cost-list < 1 ) [ "NA" ] [ max female-lifetime-half-related-help-cost-list ] end
to-report female-lifetime-half-related-help-cost-minimum report ifelse-value ( length female-lifetime-half-related-help-cost-list < 1 ) [ "NA" ] [ min female-lifetime-half-related-help-cost-list ] end
to-report female-lifetime-half-related-help-cost-mean report ifelse-value ( length female-lifetime-half-related-help-cost-list < 1 ) [ "NA" ] [ mean female-lifetime-half-related-help-cost-list ] end
to-report female-lifetime-half-related-help-cost-variance report ifelse-value ( length female-lifetime-half-related-help-cost-list < 2 ) [ "NA" ] [ variance female-lifetime-half-related-help-cost-list ] end
to-report total-population-female-lifetime-half-related-help-cost report sum female-lifetime-half-related-help-cost-list end
  
to-report male-lifetime-fourth-related-help-cost-list report [ fourth.related.help.cost ] of decayed-agents with [ biological.sex = "male" and life.history = "adult" ] end
to-report male-lifetime-fourth-related-help-cost-maximum report ifelse-value ( length male-lifetime-fourth-related-help-cost-list < 1 ) [ "NA" ] [ max male-lifetime-fourth-related-help-cost-list ] end
to-report male-lifetime-fourth-related-help-cost-minimum report ifelse-value ( length male-lifetime-fourth-related-help-cost-list < 1 ) [ "NA" ] [ min male-lifetime-fourth-related-help-cost-list ] end
to-report male-lifetime-fourth-related-help-cost-mean report ifelse-value ( length male-lifetime-fourth-related-help-cost-list < 1 ) [ "NA" ] [ mean male-lifetime-fourth-related-help-cost-list ] end
to-report male-lifetime-fourth-related-help-cost-variance report ifelse-value ( length male-lifetime-fourth-related-help-cost-list < 2 ) [ "NA" ] [ variance male-lifetime-fourth-related-help-cost-list ] end
to-report total-population-male-lifetime-fourth-related-help-cost report sum male-lifetime-fourth-related-help-cost-list end
  
to-report female-lifetime-fourth-related-help-cost-list report [ fourth.related.help.cost ] of decayed-agents with [ biological.sex = "female" and life.history = "adult" ] end
to-report female-lifetime-fourth-related-help-cost-maximum report ifelse-value ( length female-lifetime-fourth-related-help-cost-list < 1 ) [ "NA" ] [ max female-lifetime-fourth-related-help-cost-list ] end
to-report female-lifetime-fourth-related-help-cost-minimum report ifelse-value ( length female-lifetime-fourth-related-help-cost-list < 1 ) [ "NA" ] [ min female-lifetime-fourth-related-help-cost-list ] end
to-report female-lifetime-fourth-related-help-cost-mean report ifelse-value ( length female-lifetime-fourth-related-help-cost-list < 1 ) [ "NA" ] [ mean female-lifetime-fourth-related-help-cost-list ] end
to-report female-lifetime-fourth-related-help-cost-variance report ifelse-value ( length female-lifetime-fourth-related-help-cost-list < 2 ) [ "NA" ] [ variance female-lifetime-fourth-related-help-cost-list ] end
to-report total-population-female-lifetime-fourth-related-help-cost report sum female-lifetime-fourth-related-help-cost-list end
  
to-report male-lifetime-eighth-related-help-cost-list report [ eighth.related.help.cost ] of decayed-agents with [ biological.sex = "male" and life.history = "adult" ] end
to-report male-lifetime-eighth-related-help-cost-maximum report ifelse-value ( length male-lifetime-eighth-related-help-cost-list < 1 ) [ "NA" ] [ max male-lifetime-eighth-related-help-cost-list ] end
to-report male-lifetime-eighth-related-help-cost-minimum report ifelse-value ( length male-lifetime-eighth-related-help-cost-list < 1 ) [ "NA" ] [ min male-lifetime-eighth-related-help-cost-list ] end
to-report male-lifetime-eighth-related-help-cost-mean report ifelse-value ( length male-lifetime-eighth-related-help-cost-list < 1 ) [ "NA" ] [ mean male-lifetime-eighth-related-help-cost-list ] end
to-report male-lifetime-eighth-related-help-cost-variance report ifelse-value ( length male-lifetime-eighth-related-help-cost-list < 2 ) [ "NA" ] [ variance male-lifetime-eighth-related-help-cost-list ] end
to-report total-population-male-lifetime-eighth-related-help-cost report sum male-lifetime-eighth-related-help-cost-list end
  
to-report female-lifetime-eighth-related-help-cost-list report [ eighth.related.help.cost ] of decayed-agents with [ biological.sex = "female" and life.history = "adult" ] end
to-report female-lifetime-eighth-related-help-cost-maximum report ifelse-value ( length female-lifetime-eighth-related-help-cost-list < 1 ) [ "NA" ] [ max female-lifetime-eighth-related-help-cost-list ] end
to-report female-lifetime-eighth-related-help-cost-minimum report ifelse-value ( length female-lifetime-eighth-related-help-cost-list < 1 ) [ "NA" ] [ min female-lifetime-eighth-related-help-cost-list ] end
to-report female-lifetime-eighth-related-help-cost-mean report ifelse-value ( length female-lifetime-eighth-related-help-cost-list < 1 ) [ "NA" ] [ mean female-lifetime-eighth-related-help-cost-list ] end
to-report female-lifetime-eighth-related-help-cost-variance report ifelse-value ( length female-lifetime-eighth-related-help-cost-list < 2 ) [ "NA" ] [ variance female-lifetime-eighth-related-help-cost-list ] end
to-report total-population-female-lifetime-eighth-related-help-cost report sum female-lifetime-eighth-related-help-cost-list end
  
to-report male-lifetime-not-related-help-cost-list report [ not.related.help.cost ] of decayed-agents with [ biological.sex = "male" and life.history = "adult" ] end
to-report male-lifetime-not-related-help-cost-maximum report ifelse-value ( length male-lifetime-not-related-help-cost-list < 1 ) [ "NA" ] [ max male-lifetime-not-related-help-cost-list ] end
to-report male-lifetime-not-related-help-cost-minimum report ifelse-value ( length male-lifetime-not-related-help-cost-list < 1 ) [ "NA" ] [ min male-lifetime-not-related-help-cost-list ] end
to-report male-lifetime-not-related-help-cost-mean report ifelse-value ( length male-lifetime-not-related-help-cost-list < 1 ) [ "NA" ] [ mean male-lifetime-not-related-help-cost-list ] end
to-report male-lifetime-not-related-help-cost-variance report ifelse-value ( length male-lifetime-not-related-help-cost-list < 2 ) [ "NA" ] [ variance male-lifetime-not-related-help-cost-list ] end
to-report total-population-male-lifetime-not-related-help-cost report sum male-lifetime-not-related-help-cost-list end
  
to-report female-lifetime-not-related-help-cost-list report [ not.related.help.cost ] of decayed-agents with [ biological.sex = "female" and life.history = "adult" ] end
to-report female-lifetime-not-related-help-cost-maximum report ifelse-value ( length female-lifetime-not-related-help-cost-list < 1 ) [ "NA" ] [ max female-lifetime-not-related-help-cost-list ] end
to-report female-lifetime-not-related-help-cost-minimum report ifelse-value ( length female-lifetime-not-related-help-cost-list < 1 ) [ "NA" ] [ min female-lifetime-not-related-help-cost-list ] end
to-report female-lifetime-not-related-help-cost-mean report ifelse-value ( length female-lifetime-not-related-help-cost-list < 1 ) [ "NA" ] [ mean female-lifetime-not-related-help-cost-list ] end
to-report female-lifetime-not-related-help-cost-variance report ifelse-value ( length female-lifetime-not-related-help-cost-list < 2 ) [ "NA" ] [ variance female-lifetime-not-related-help-cost-list ] end
to-report total-population-female-lifetime-not-related-help-cost report sum female-lifetime-not-related-help-cost-list end
  
to-report male-lifetime-whole-related-attack-cost-list report [ whole.related.attack.cost ] of decayed-agents with [ biological.sex = "male" and life.history = "adult" ] end
to-report male-lifetime-whole-related-attack-cost-maximum report ifelse-value ( length male-lifetime-whole-related-attack-cost-list < 1 ) [ "NA" ] [ max male-lifetime-whole-related-attack-cost-list ] end
to-report male-lifetime-whole-related-attack-cost-minimum report ifelse-value ( length male-lifetime-whole-related-attack-cost-list < 1 ) [ "NA" ] [ min male-lifetime-whole-related-attack-cost-list ] end
to-report male-lifetime-whole-related-attack-cost-mean report ifelse-value ( length male-lifetime-whole-related-attack-cost-list < 1 ) [ "NA" ] [ mean male-lifetime-whole-related-attack-cost-list ] end
to-report male-lifetime-whole-related-attack-cost-variance report ifelse-value ( length male-lifetime-whole-related-attack-cost-list < 2 ) [ "NA" ] [ variance male-lifetime-whole-related-attack-cost-list ] end
to-report total-population-male-lifetime-whole-related-attack-cost report sum male-lifetime-whole-related-attack-cost-list end
  
to-report female-lifetime-whole-related-attack-cost-list report [ whole.related.attack.cost ] of decayed-agents with [ biological.sex = "female" and life.history = "adult" ] end
to-report female-lifetime-whole-related-attack-cost-maximum report ifelse-value ( length female-lifetime-whole-related-attack-cost-list < 1 ) [ "NA" ] [ max female-lifetime-whole-related-attack-cost-list ] end
to-report female-lifetime-whole-related-attack-cost-minimum report ifelse-value ( length female-lifetime-whole-related-attack-cost-list < 1 ) [ "NA" ] [ min female-lifetime-whole-related-attack-cost-list ] end
to-report female-lifetime-whole-related-attack-cost-mean report ifelse-value ( length female-lifetime-whole-related-attack-cost-list < 1 ) [ "NA" ] [ mean female-lifetime-whole-related-attack-cost-list ] end
to-report female-lifetime-whole-related-attack-cost-variance report ifelse-value ( length female-lifetime-whole-related-attack-cost-list < 2 ) [ "NA" ] [ variance female-lifetime-whole-related-attack-cost-list ] end
to-report total-population-female-lifetime-whole-related-attack-cost report sum female-lifetime-whole-related-attack-cost-list end
  
to-report male-lifetime-half-related-attack-cost-list report [ half.related.attack.cost ] of decayed-agents with [ biological.sex = "male" and life.history = "adult" ] end
to-report male-lifetime-half-related-attack-cost-maximum report ifelse-value ( length male-lifetime-half-related-attack-cost-list < 1 ) [ "NA" ] [ max male-lifetime-half-related-attack-cost-list ] end
to-report male-lifetime-half-related-attack-cost-minimum report ifelse-value ( length male-lifetime-half-related-attack-cost-list < 1 ) [ "NA" ] [ min male-lifetime-half-related-attack-cost-list ] end
to-report male-lifetime-half-related-attack-cost-mean report ifelse-value ( length male-lifetime-half-related-attack-cost-list < 1 ) [ "NA" ] [ mean male-lifetime-half-related-attack-cost-list ] end
to-report male-lifetime-half-related-attack-cost-variance report ifelse-value ( length male-lifetime-half-related-attack-cost-list < 2 ) [ "NA" ] [ variance male-lifetime-half-related-attack-cost-list ] end
to-report total-population-male-lifetime-half-related-attack-cost report sum male-lifetime-half-related-attack-cost-list end
  
to-report female-lifetime-half-related-attack-cost-list report [ half.related.attack.cost ] of decayed-agents with [ biological.sex = "female" and life.history = "adult" ] end
to-report female-lifetime-half-related-attack-cost-maximum report ifelse-value ( length female-lifetime-half-related-attack-cost-list < 1 ) [ "NA" ] [ max female-lifetime-half-related-attack-cost-list ] end
to-report female-lifetime-half-related-attack-cost-minimum report ifelse-value ( length female-lifetime-half-related-attack-cost-list < 1 ) [ "NA" ] [ min female-lifetime-half-related-attack-cost-list ] end
to-report female-lifetime-half-related-attack-cost-mean report ifelse-value ( length female-lifetime-half-related-attack-cost-list < 1 ) [ "NA" ] [ mean female-lifetime-half-related-attack-cost-list ] end
to-report female-lifetime-half-related-attack-cost-variance report ifelse-value ( length female-lifetime-half-related-attack-cost-list < 2 ) [ "NA" ] [ variance female-lifetime-half-related-attack-cost-list ] end
to-report total-population-female-lifetime-half-related-attack-cost report sum female-lifetime-half-related-attack-cost-list end
  
to-report male-lifetime-fourth-related-attack-cost-list report [ fourth.related.attack.cost ] of decayed-agents with [ biological.sex = "male" and life.history = "adult" ] end
to-report male-lifetime-fourth-related-attack-cost-maximum report ifelse-value ( length male-lifetime-fourth-related-attack-cost-list < 1 ) [ "NA" ] [ max male-lifetime-fourth-related-attack-cost-list ] end
to-report male-lifetime-fourth-related-attack-cost-minimum report ifelse-value ( length male-lifetime-fourth-related-attack-cost-list < 1 ) [ "NA" ] [ min male-lifetime-fourth-related-attack-cost-list ] end
to-report male-lifetime-fourth-related-attack-cost-mean report ifelse-value ( length male-lifetime-fourth-related-attack-cost-list < 1 ) [ "NA" ] [ mean male-lifetime-fourth-related-attack-cost-list ] end
to-report male-lifetime-fourth-related-attack-cost-variance report ifelse-value ( length male-lifetime-fourth-related-attack-cost-list < 2 ) [ "NA" ] [ variance male-lifetime-fourth-related-attack-cost-list ] end
to-report total-population-male-lifetime-fourth-related-attack-cost report sum male-lifetime-fourth-related-attack-cost-list end
  
to-report female-lifetime-fourth-related-attack-cost-list report [ fourth.related.attack.cost ] of decayed-agents with [ biological.sex = "female" and life.history = "adult" ] end
to-report female-lifetime-fourth-related-attack-cost-maximum report ifelse-value ( length female-lifetime-fourth-related-attack-cost-list < 1 ) [ "NA" ] [ max female-lifetime-fourth-related-attack-cost-list ] end
to-report female-lifetime-fourth-related-attack-cost-minimum report ifelse-value ( length female-lifetime-fourth-related-attack-cost-list < 1 ) [ "NA" ] [ min female-lifetime-fourth-related-attack-cost-list ] end
to-report female-lifetime-fourth-related-attack-cost-mean report ifelse-value ( length female-lifetime-fourth-related-attack-cost-list < 1 ) [ "NA" ] [ mean female-lifetime-fourth-related-attack-cost-list ] end
to-report female-lifetime-fourth-related-attack-cost-variance report ifelse-value ( length female-lifetime-fourth-related-attack-cost-list < 2 ) [ "NA" ] [ variance female-lifetime-fourth-related-attack-cost-list ] end
to-report total-population-female-lifetime-fourth-related-attack-cost report sum female-lifetime-fourth-related-attack-cost-list end
  
to-report male-lifetime-eighth-related-attack-cost-list report [ eighth.related.attack.cost ] of decayed-agents with [ biological.sex = "male" and life.history = "adult" ] end
to-report male-lifetime-eighth-related-attack-cost-maximum report ifelse-value ( length male-lifetime-eighth-related-attack-cost-list < 1 ) [ "NA" ] [ max male-lifetime-eighth-related-attack-cost-list ] end
to-report male-lifetime-eighth-related-attack-cost-minimum report ifelse-value ( length male-lifetime-eighth-related-attack-cost-list < 1 ) [ "NA" ] [ min male-lifetime-eighth-related-attack-cost-list ] end
to-report male-lifetime-eighth-related-attack-cost-mean report ifelse-value ( length male-lifetime-eighth-related-attack-cost-list < 1 ) [ "NA" ] [ mean male-lifetime-eighth-related-attack-cost-list ] end
to-report male-lifetime-eighth-related-attack-cost-variance report ifelse-value ( length male-lifetime-eighth-related-attack-cost-list < 2 ) [ "NA" ] [ variance male-lifetime-eighth-related-attack-cost-list ] end
to-report total-population-male-lifetime-eighth-related-attack-cost report sum male-lifetime-eighth-related-attack-cost-list end
  
to-report female-lifetime-eighth-related-attack-cost-list report [ eighth.related.attack.cost ] of decayed-agents with [ biological.sex = "female" and life.history = "adult" ] end
to-report female-lifetime-eighth-related-attack-cost-maximum report ifelse-value ( length female-lifetime-eighth-related-attack-cost-list < 1 ) [ "NA" ] [ max female-lifetime-eighth-related-attack-cost-list ] end
to-report female-lifetime-eighth-related-attack-cost-minimum report ifelse-value ( length female-lifetime-eighth-related-attack-cost-list < 1 ) [ "NA" ] [ min female-lifetime-eighth-related-attack-cost-list ] end
to-report female-lifetime-eighth-related-attack-cost-mean report ifelse-value ( length female-lifetime-eighth-related-attack-cost-list < 1 ) [ "NA" ] [ mean female-lifetime-eighth-related-attack-cost-list ] end
to-report female-lifetime-eighth-related-attack-cost-variance report ifelse-value ( length female-lifetime-eighth-related-attack-cost-list < 2 ) [ "NA" ] [ variance female-lifetime-eighth-related-attack-cost-list ] end
to-report total-population-female-lifetime-eighth-related-attack-cost report sum female-lifetime-eighth-related-attack-cost-list end
  
to-report male-lifetime-not-related-attack-cost-list report [ not.related.attack.cost ] of decayed-agents with [ biological.sex = "male" and life.history = "adult" ] end
to-report male-lifetime-not-related-attack-cost-maximum report ifelse-value ( length male-lifetime-not-related-attack-cost-list < 1 ) [ "NA" ] [ max male-lifetime-not-related-attack-cost-list ] end
to-report male-lifetime-not-related-attack-cost-minimum report ifelse-value ( length male-lifetime-not-related-attack-cost-list < 1 ) [ "NA" ] [ min male-lifetime-not-related-attack-cost-list ] end
to-report male-lifetime-not-related-attack-cost-mean report ifelse-value ( length male-lifetime-not-related-attack-cost-list < 1 ) [ "NA" ] [ mean male-lifetime-not-related-attack-cost-list ] end
to-report male-lifetime-not-related-attack-cost-variance report ifelse-value ( length male-lifetime-not-related-attack-cost-list < 2 ) [ "NA" ] [ variance male-lifetime-not-related-attack-cost-list ] end
to-report total-population-male-lifetime-not-related-attack-cost report sum male-lifetime-not-related-attack-cost-list end
        
to-report female-lifetime-not-related-attack-cost-list report [ not.related.attack.cost ] of decayed-agents with [ biological.sex = "female" and life.history = "adult" ] end
to-report female-lifetime-not-related-attack-cost-maximum report ifelse-value ( length female-lifetime-not-related-attack-cost-list < 1 ) [ "NA" ] [ max female-lifetime-not-related-attack-cost-list ] end
to-report female-lifetime-not-related-attack-cost-minimum report ifelse-value ( length female-lifetime-not-related-attack-cost-list < 1 ) [ "NA" ] [ min female-lifetime-not-related-attack-cost-list ] end
to-report female-lifetime-not-related-attack-cost-mean report ifelse-value ( length female-lifetime-not-related-attack-cost-list < 1 ) [ "NA" ] [ mean female-lifetime-not-related-attack-cost-list ] end
to-report female-lifetime-not-related-attack-cost-variance report ifelse-value ( length female-lifetime-not-related-attack-cost-list < 2 ) [ "NA" ] [ variance female-lifetime-not-related-attack-cost-list ] end
to-report total-population-female-lifetime-not-related-attack-cost report sum female-lifetime-not-related-attack-cost-list end
        
to-report male-total-help-from-count-list report [ length help.from.history ] of decayed-agents with [ biological.sex = "male" and life.history = "adult" ] end
to-report male-total-help-from-count-maximum report ifelse-value ( length male-total-help-from-count-list < 1 ) [ "NA" ] [ max male-total-help-from-count-list ] end
to-report male-total-help-from-count-minimum report ifelse-value ( length male-total-help-from-count-list < 1 ) [ "NA" ] [ min male-total-help-from-count-list ] end
to-report male-total-help-from-count-mean report ifelse-value ( length male-total-help-from-count-list < 1 ) [ "NA" ] [ mean male-total-help-from-count-list ] end
to-report male-total-help-from-count-variance report ifelse-value ( length male-total-help-from-count-list < 2 ) [ "NA" ] [ variance male-total-help-from-count-list ] end
to-report total-population-male-total-help-from-count report sum male-total-help-from-count-list end
        
to-report female-total-help-from-count-list report [ length help.from.history ] of decayed-agents with [ biological.sex = "female" and life.history = "adult" ] end
to-report female-total-help-from-count-maximum report ifelse-value ( length female-total-help-from-count-list < 1 ) [ "NA" ] [ max female-total-help-from-count-list ] end
to-report female-total-help-from-count-minimum report ifelse-value ( length female-total-help-from-count-list < 1 ) [ "NA" ] [ min female-total-help-from-count-list ] end
to-report female-total-help-from-count-mean report ifelse-value ( length female-total-help-from-count-list < 1 ) [ "NA" ] [ mean female-total-help-from-count-list ] end
to-report female-total-help-from-count-variance report ifelse-value ( length female-total-help-from-count-list < 2 ) [ "NA" ] [ variance female-total-help-from-count-list ] end
to-report total-population-female-total-help-from-count report sum female-total-help-from-count-list end
        
to-report male-total-attack-from-count-list report [ length attack.from.history ] of decayed-agents with [ biological.sex = "male" and life.history = "adult" ]  end
to-report male-total-attack-from-count-maximum report ifelse-value ( length male-total-attack-from-count-list < 1 ) [ "NA" ] [ max male-total-attack-from-count-list ] end
to-report male-total-attack-from-count-minimum report ifelse-value ( length male-total-attack-from-count-list < 1 ) [ "NA" ] [ min male-total-attack-from-count-list ] end
to-report male-total-attack-from-count-mean report ifelse-value ( length male-total-attack-from-count-list < 1 ) [ "NA" ] [ mean male-total-attack-from-count-list ] end
to-report male-total-attack-from-count-variance report ifelse-value ( length male-total-attack-from-count-list < 2 ) [ "NA" ] [ variance male-total-attack-from-count-list ] end
to-report total-population-male-total-attack-from-count report sum male-total-attack-from-count-list end
        
to-report female-total-attack-from-count-list report [ length attack.from.history ] of decayed-agents with [ biological.sex = "female" and life.history = "adult" ] end
to-report female-total-attack-from-count-maximum report ifelse-value ( length female-total-attack-from-count-list < 1 ) [ "NA" ] [ max female-total-attack-from-count-list ] end
to-report female-total-attack-from-count-minimum report ifelse-value ( length female-total-attack-from-count-list < 1 ) [ "NA" ] [ min female-total-attack-from-count-list ] end
to-report female-total-attack-from-count-mean report ifelse-value ( length female-total-attack-from-count-list < 1 ) [ "NA" ] [ mean female-total-attack-from-count-list ] end
to-report female-total-attack-from-count-variance report ifelse-value ( length female-total-attack-from-count-list < 2 ) [ "NA" ] [ variance female-total-attack-from-count-list ] end
to-report total-population-female-total-attack-from-count report sum female-total-attack-from-count-list end
  
to-report male-total-matings-list report [ length copulations.history ] of decayed-agents with [ biological.sex = "male" and life.history = "adult" ] end
to-report male-total-matings-maximum report ifelse-value ( length male-total-matings-list < 1 ) [ "NA" ] [ max male-total-matings-list ] end
to-report male-total-matings-minimum report ifelse-value ( length male-total-matings-list < 1 ) [ "NA" ] [ min male-total-matings-list ] end
to-report male-total-matings-mean report ifelse-value ( length male-total-matings-list < 1 ) [ "NA" ] [ mean male-total-matings-list ] end
to-report male-total-matings-variance report ifelse-value ( length male-total-matings-list < 2 ) [ "NA" ] [ variance male-total-matings-list ] end
to-report total-population-male-total-matings report sum male-total-matings-list end
  
to-report female-total-matings-list report [ length copulations.history ] of decayed-agents with [ biological.sex = "female" and life.history = "adult" ] end
to-report female-total-matings-maximum report ifelse-value ( length female-total-matings-list < 1 ) [ "NA" ] [ max female-total-matings-list ] end
to-report female-total-matings-minimum report ifelse-value ( length female-total-matings-list < 1 ) [ "NA" ] [ min female-total-matings-list ] end
to-report female-total-matings-mean report ifelse-value ( length female-total-matings-list < 1 ) [ "NA" ] [ mean female-total-matings-list ] end
to-report female-total-matings-variance report ifelse-value ( length female-total-matings-list < 2 ) [ "NA" ] [ variance female-total-matings-list ] end
to-report total-population-female-total-matings report sum female-total-matings-list end
  
to-report male-unique-female-matings-list report [ length remove-duplicates copulations.history ] of decayed-agents with [ biological.sex = "male" and life.history = "adult" ] end
to-report male-unique-female-matings-maximum report ifelse-value ( length male-unique-female-matings-list < 1 ) [ "NA" ] [ max male-unique-female-matings-list ] end
to-report male-unique-female-matings-minimum report ifelse-value ( length male-unique-female-matings-list < 1 ) [ "NA" ] [ min male-unique-female-matings-list ] end
to-report male-unique-female-matings-mean report ifelse-value ( length male-unique-female-matings-list < 1 ) [ "NA" ] [ mean male-unique-female-matings-list ] end
to-report male-unique-female-matings-variance report ifelse-value ( length male-unique-female-matings-list < 2 ) [ "NA" ] [ variance male-unique-female-matings-list ] end
to-report total-population-male-unique-female-matings report length remove-duplicates reduce sentence [ copulations.history ] of decayed-agents with [ biological.sex = "male" and life.history = "adult" ] end 
  
to-report female-unique-male-matings-list report [ length remove-duplicates copulations.history ] of decayed-agents with [ biological.sex = "female" and life.history = "adult" ] end
to-report female-unique-male-matings-maximum report ifelse-value ( length female-unique-male-matings-list < 1 ) [ "NA" ] [ max female-unique-male-matings-list ] end
to-report female-unique-male-matings-minimum report ifelse-value ( length female-unique-male-matings-list < 1 ) [ "NA" ] [ min female-unique-male-matings-list ] end
to-report female-unique-male-matings-mean report ifelse-value ( length female-unique-male-matings-list < 1 ) [ "NA" ] [ mean female-unique-male-matings-list ] end
to-report female-unique-male-matings-variance report ifelse-value ( length female-unique-male-matings-list < 2 ) [ "NA" ] [ variance female-unique-male-matings-list ] end
to-report total-population-female-unique-male-matings report length remove-duplicates reduce sentence [ copulations.history ] of decayed-agents with [ biological.sex = "female" and life.history = "adult" ] end
  
to-report male-total-group-transfers-list report [ length group.transfers.history ] of decayed-agents with [ biological.sex = "male" and life.history = "adult" ] end
to-report male-total-group-transfers-maximum report ifelse-value ( length male-total-group-transfers-list < 1 ) [ "NA" ] [ max male-total-group-transfers-list ] end
to-report male-total-group-transfers-minimum report ifelse-value ( length male-total-group-transfers-list < 1 ) [ "NA" ] [ min male-total-group-transfers-list ] end
to-report male-total-group-transfers-mean report ifelse-value ( length male-total-group-transfers-list < 1 ) [ "NA" ] [ mean male-total-group-transfers-list ] end
to-report male-total-group-transfers-variance report ifelse-value ( length male-total-group-transfers-list < 2 ) [ "NA" ] [ variance male-total-group-transfers-list ] end
to-report total-population-male-total-group-transfers report sum male-total-group-transfers-list end
  
to-report female-total-group-transfers-list report [ length group.transfers.history ] of decayed-agents with [ biological.sex = "female" and life.history = "adult" ] end
to-report female-total-group-transfers-maximum report ifelse-value ( length female-total-group-transfers-list < 1 ) [ "NA" ] [ max female-total-group-transfers-list ] end
to-report female-total-group-transfers-minimum report ifelse-value ( length female-total-group-transfers-list < 1 ) [ "NA" ] [ min female-total-group-transfers-list ] end
to-report female-total-group-transfers-mean report ifelse-value ( length female-total-group-transfers-list < 1 ) [ "NA" ] [ mean female-total-group-transfers-list ] end
to-report female-total-group-transfers-variance report ifelse-value ( length female-total-group-transfers-list < 2 ) [ "NA" ] [ variance female-total-group-transfers-list ] end
to-report total-population-female-total-group-transfers report sum female-total-group-transfers-list end
  
to-report male-infanticide-count-list report [ length filter [ i -> any? anima1s with [ not is.alive and my.identity = i ] ] remove-duplicates infanticide.history ] of decayed-agents with [ biological.sex = "male" and life.history = "adult" ] end
to-report male-infanticide-count-maximum report ifelse-value ( length male-infanticide-count-list < 1 ) [ "NA" ] [ max male-infanticide-count-list ] end
to-report male-infanticide-count-minimum report ifelse-value ( length male-infanticide-count-list < 1 ) [ "NA" ] [ min male-infanticide-count-list ] end
to-report male-infanticide-count-mean report ifelse-value ( length male-infanticide-count-list < 1 ) [ "NA" ] [ mean male-infanticide-count-list ] end
to-report male-infanticide-count-variance report ifelse-value ( length male-infanticide-count-list < 2 ) [ "NA" ] [ variance male-infanticide-count-list ] end
to-report total-population-male-infanticide-count report length filter [ i -> any? anima1s with [ not is.alive and my.identity = i ] ] remove-duplicates reduce sentence [ infanticide.history ] of decayed-agents with [ biological.sex = "male" and life.history = "adult" ] end
        
to-report female-infanticide-count-list report [ length filter [ i -> any? anima1s with [ not is.alive and my.identity = i ] ] remove-duplicates infanticide.history ] of decayed-agents with [ biological.sex = "female" and life.history = "adult" ] end
to-report female-infanticide-count-maximum report ifelse-value ( length female-infanticide-count-list < 1 ) [ "NA" ] [ max female-infanticide-count-list ] end
to-report female-infanticide-count-minimum report ifelse-value ( length female-infanticide-count-list < 1 ) [ "NA" ] [ min female-infanticide-count-list ] end
to-report female-infanticide-count-mean report ifelse-value ( length female-infanticide-count-list < 1 ) [ "NA" ] [ mean female-infanticide-count-list ] end
to-report female-infanticide-count-variance report ifelse-value ( length female-infanticide-count-list < 2 ) [ "NA" ] [ variance female-infanticide-count-list ] end
to-report total-population-female-infanticide-count report length filter [ i -> any? anima1s with [ not is.alive and my.identity = i ] ] remove-duplicates reduce sentence [ infanticide.history ] of decayed-agents with [ biological.sex = "female" and life.history = "adult" ] end


